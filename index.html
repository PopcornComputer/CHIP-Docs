<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
		<link rel="shortcut icon" href="//s3-us-west-2.amazonaws.com/ntcpublic/icon-16.png" type="image/x-icon">
    <link rel="icon" href="//s3-us-west-2.amazonaws.com/ntcpublic/icon-16.png" type="image/x-icon">
		
    <title>Popcorn Computer Documentation</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #272822;
  background-color: #f92672;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #75715e;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #f8f8f2;
}
.highlight .p, .highlight .pi {
  color: #f8f8f2;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #ae81ff;
}
.highlight .kc {
  color: #fd971f;
}
.highlight .kt {
  color: #fd971f;
}
.highlight .kd {
  color: #fd971f;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #a6e22e;
}
.highlight .sr {
  color: #a1efe4;
}
.highlight .si {
  color: #cc6633;
}
.highlight .se {
  color: #cc6633;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #66d9ef;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #a6e22e;
}
.highlight .ss {
  color: #a6e22e;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
    
    <link href="stylesheets/ntc_override.css" rel="stylesheet" media="screen" />
    
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[]">
    <a href="#" id="nav-button">
      <span>
        NAVI
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
    
      <div class="nav-bar-logo">
        <a href="index.html"><img src="images/ntclogo_doccorner.png" alt="Ntclogo doccorner" /></a>
      </div>
      
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://github.com/PopcornComputer/CHIP-Docs'>Have something to add or change?<br>Visit our GitHub!</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="introduction">Introduction</h1>

<p>Welcome to Popcorn Computer&rsquo;s CHIP documentation.</p>

          <h1 id="welcome-to-the-chip-operating-system">Welcome to The CHIP Operating System</h1>

<p>We made a computer. And every computer needs an operating system. </p>

<p>Ours is The CHIP Operating System. Grab an old TV (or any screen with a composite video input), a keyboard and mouse, and stick some electricity in the micro USB port. In a few seconds, you&rsquo;ll have CHIP&rsquo;s operating system on your screen, ready to do <strong>computer things.</strong> </p>

<p><img src="images/screen_desktop.jpg" alt="DERP desktop" /></p>

<p>CHIP is built for making - we&rsquo;ve packed a powerful processor, 4 GB of storage, stereo audio, video out,  and lots of connections for playing and making your projects and products. </p>

<p>The CHIP Operating System is built for doing: browse the &lsquo;net, send email, play video games, listen to music, write a novel, watch a video, or learn programming. And because it&rsquo;s based on the popular Linux Debian, if there&rsquo;s something you need, you can probably install it. </p>

<p>So how do use this thing? Let&rsquo;s get started.</p>

          <h1 id="start-chip-boot-chip">Start CHIP. Boot CHIP.</h1>

<p>First things first. Let&rsquo;s boot CHIP into the CHIP Operating System and do some computer things! Add some power, turn on the wireless network, and even connect a bluetooth keyboard to get rid of those annoying cables.</p>

<h2 id="power-up">Power Up</h2>

<p>The single most important thing to using any electronic device is getting electricity to the right places. We&rsquo;re going to cover how to turn CHIP &ldquo;on&rdquo;. This might seem so straightforward that it doesn&rsquo;t deserve several paragraphs, but CHIP is pretty clever, so there&rsquo;s actually a few things worth knowing.</p>

<h3 id="what-39-s-it-need">What&rsquo;s It Need?</h3>

<p>In general, CHIP is powered by a 5-volt source like a USB port or phone charger, and draws about 500mA peak (at boot time), runs on around 200mA, and rests with around 80mA with the processor totally unloaded. To make sure you have enough headroom, we recommend that you use a 5v power supply with  2 Amps current available (you could go as low as 900mA, but you risk brown-outs). This may be more than you need to know if you just want to plug it in to the wall, but, as you build projects with CHIP, you&rsquo;ll be happy to know there&rsquo;s a lot of ways to get the electricity flowing.</p>

<h3 id="how-do-i-know-chip-is-on">How Do I Know CHIP Is On?</h3>

<p>CHIP is silent. It doesn&rsquo;t take much energy, so it&rsquo;s not very hot. It has no discernible smell. As a result, many of your senses are not great indicators that it is working. There are two LEDs next to the USB micro connector. When CHIP is on, you should see the <code class="prettyprint">PWR</code> LED light up nice and bright.</p>

<h3 id="power-from-the-wall">Power From The Wall</h3>

<p>The CHIP&rsquo;s microUSB connector is used to provide power from most any USB power source. USB wall-wart adapters are probably littered all over your house. If for some reason you don&rsquo;t have one, you can buy one at any electronics retailer. We recommend a 5V powersupply with 2 Amps current available. Just plug a USB-A-to-microUSB-B cable (that&rsquo;s the same cable most phones, tablets, and whatnot use to charge) into the wall-wart and CHIP, and you&rsquo;ll see the <code class="prettyprint">PWR</code> LED light up. This CHIP is using the power from a computer&rsquo;s USB port:</p>

<p><img src="images/chip_ledon.jpg" alt="CHIP indicator LEDs" /></p>

<h3 id="power-from-a-battery">Power From A Battery</h3>

<p>CHIP can also be battery powered. Specifically, any single cell (1S) 3.7V Lithium Polymer (LiPo) battery with a 2-pin JST-PH 2.0mm end can be connected to the JST-PH socket.</p>

<p><img src="images/chip_battery.jpg" alt="CHIP powered by a battery. Slick!" /></p>

<p>The JST can only plug it in one way: if you are having a hard time lining things up, turn it around! Needless to say, do not force the battery connector into the socket if something doesn&rsquo;t feel right!</p>

<p>If you have added a connector to your own battery, make sure you have the JST wired correctly: the (-) connection should be on the <strong>outside</strong> edge of CHIP.</p>

<p>What&rsquo;s really great is that if you plug in to a charger and plug in a battery, the battery will charge - all the power management is on CHIP itself. Roughly, it takes about four to six hours to charge a 3000 mAh LiPo battery from a 5V 2A power source. Also, our delightful little Power Management IC, the AXP209, handles pass-through power, so while on and charging a battery, CHIP is basically running on a un-interruped power supply &ndash; If charge power fails, CHIP seamlessly switches onto battery power without shutting off.</p>

<p>Now you&rsquo;re ready to <a href="#recommended-accessories">connect CHIP to a screen, keyboard and mouse</a> or even work on CHIP from <a href="#headless-chip">another computer</a>.</p>

<h3 id="button">Button</h3>

<p>There is a tiny tiny button on CHIP next to pin header U13 that is used for turning CHIP on or off. If CHIP is off and connected to a power source, hold down the button for one second to power it up. To turn CHIP off (rather brutally), hold the button for 10 seconds. We recommend using the operating system to power CHIP off, but if you need to, you can use this button.</p>

<h2 id="connect-to-wifi">Connect To WiFi</h2>

<p>Connecting to a WiFi network is easy using the WiFi icon the top right system tray. Just select a network to initiate a connection. If the network requires a password you’ll be prompted for it. You can also <a href="#wifi-connection">set up Wi-Fi from the command line</a>.</p>

<p><img src="images/screen_wifisettings.jpg" alt="Select a wireless connection access point" /></p>

<p>If you need more control and information over your network connection, use the Settings-&gt;Network Connections panel to show your connections. Double click on a connection to bring up the connection editor:</p>

<p><img src="images/screen_networksettings.jpg" alt="Network connection editor" /></p>

<h2 id="connect-bluetooth">Connect Bluetooth</h2>

<p>Bluetooth device setup can be accessed using the Bluetooth icon in the top right system tray.</p>

<p><img src="images/screen_btsettings.jpg" alt="Bluetooth settings menu" /></p>

<p>When you begin a connection, you&rsquo;ll be guided through the necessary steps to connect to your device. For example, when you pair with a keyboard, you&rsquo;ll often be prompted for a code to enter to ensure a unique connection. Once you have paired a device, future connections will usually be automatic when the devices are in range and powered up.</p>

<p><img src="images/screen_btsetup01.jpg" alt="Bluetooth settings menu" /></p>

<p>You can manage, and also connect to, your devices using the the Bluetooth Devices panel, accessed from the Bluetooth system tray:</p>

<p><img src="images/screen_btdevices.jpg" alt="Bluetooth devices panel" /></p>

<h2 id="using-the-terminal">Using The Terminal</h2>

<p>One of the great powers of Linux is the so-called &ldquo;command-line.&rdquo; This simple text interface for computing unveils many of the gears and levers that make a computer tick. Many find it easier to get things done, as it is a focused and terse way to interact with the computer.</p>

<p>When you first use the Terminal Emulator program, you may quickly find that you do not have permission to do something. That is because many commands are safely reserved for &ldquo;root&rdquo; access, and you are automatically logged in as the &ldquo;chip&rdquo; user. Don&rsquo;t fear: you can often use the <code class="prettyprint">sudo</code> command and use the default password <code class="prettyprint">chip</code> to execute these restricted commands.</p>

<p>Finally, it is probably wise to change the default password on your CHIP. You can do with with</p>
<pre class="highlight shell"><code>passwd
</code></pre>
<p>or</p>
<pre class="highlight shell"><code>sudo passwd root
</code></pre>
<p>and you&rsquo;ll be asked for a new password. Don&rsquo;t forget it!!</p>

<p>If you are such a fan of the command line, you may want to boot with out the desktop and window system. Instructions for that are <a href="#boot-into-console">here</a></p>

<h2 id="terminal-for-beginners-glossary">Terminal for Beginners Glossary</h2>

<p>One of the great things about Linux is the terminal application. 
While it may look unfriendly and terse, if you want to really extend the capabilities of CHIP, you&rsquo;ll often find yourself in the terminal. 
If you&rsquo;re a beginner, here&rsquo;s a quick reference of some really important and common commands. You can simply add <code class="prettyprint">-h</code> to get some hints on how to use a command, such as <code class="prettyprint">cp -h</code> or you can read a manual page using <code class="prettyprint">man cp</code>. Most unix commands have a variety of options that can be executed in the command with <em>flags</em>, such as <code class="prettyprint">ls -l -a</code>. Even better, search the internet! This primer is simply here to help you understand what a command might be doing, not to help you use it to its full ability.</p>

<ul>
<li><strong>cd</strong> change directory. open a folder. ex: <code class="prettyprint">cd ~/Pictures</code> changes your current directory to the home Pictures folder, so you can easily access the files within.</li>
<li><strong>mkdir</strong> make directory. create a folder. ex: <code class="prettyprint">mkdir Vacation</code> makes a folder named <em>Vacation</em> in the current directory. <code class="prettyprint">mkdir ~/Pictures/Vacation</code> makes a <code class="prettyprint">Vacation</code> folder in the home Pictures directory.</li>
<li><strong>ls</strong> list files in the current directory so you know what is in it. Some options are <code class="prettyprint">ls -l</code> to list in long format to provide information about permissions, size, and date. <code class="prettyprint">ls -a</code> to show hidden files that start with the <code class="prettyprint">.</code> character.</li>
<li><strong>mv</strong> move a file from one directory to another, or to give it a new name. Ex: <code class="prettyprint">mv this.one that.one</code> renames a file. <code class="prettyprint">mv this.one ~/Pictures/Vacation/</code> puts the file <em>this.one</em> into the <code class="prettyprint">Vacation</code> directory.</li>
<li><strong>cp</strong> copy a file from one place to another. Ex: <code class="prettyprint">cp this.one this_01.one</code> will copy <code class="prettyprint">this.one</code> to another file <code class="prettyprint">this_01.one</code>. Add directories for more fun: <code class="prettyprint">cp ~/Pictures/Vacation/saturn.jpg /Users/otherone/Pictures/Vacation/saturn.jpg</code>. </li>
<li><strong>rm</strong> remove a file. delete it, and beware!. Use the <code class="prettyprint">-r</code> to make it recursive to delete a directory. Ex: <code class="prettyprint">rm this.one</code> deletes that file. <code class="prettyprint">rm -r ~/Pictures/Vacation</code> to forget the good times.</li>
<li><strong>sudo</strong> super user do. many commands need administrator-like privileges, otherwise they won&rsquo;t work. <code class="prettyprint">apt-get</code> is a command that needs to be run with <code class="prettyprint">sudo</code> to allow files to be written to protected directories. You&rsquo;ll see <code class="prettyprint">sudo</code> as the first word in a lot of commands - all it is doing is giving the command the necessary access. You&rsquo;ll be asked for a password the first time you use <code class="prettyprint">sudo</code>. The default password and user is &ldquo;chip&rdquo;.</li>
<li><strong>apt-get</strong> the command used for installing, removing, and finding software for Debian Linux systems, such as the CHIP Operating System. <code class="prettyprint">sudo apt-get install puredata</code> installs the Pure Data program and any dependencies. <code class="prettyprint">sudo apt-get remove puredata</code> will remove the program. <code class="prettyprint">sudo apt-cache search image</code> will search apt repositories for the keyword <em>search</em>. And so on.</li>
<li><strong>pwd</strong> present working directory. In case you forget where you are. Not much to it: <code class="prettyprint">pwd</code> will output the directory name, such as <code class="prettyprint">/Users/home/chip/Pictures/Vacation/</code></li>
<li><strong>grep</strong> a tool used for searching through files. It&rsquo;s quite deep and can be complicated, but if you see the word <code class="prettyprint">grep</code> in some command, you know it&rsquo;s searching for a match.</li>
<li><strong>| (pipe)</strong>  a command used to redirect data into an application.</li>
<li><strong>&lt; (redirect)</strong> a command use to redirect data into a file.</li>
<li><strong>cat</strong> and <strong>echo</strong> concactenate. append data to a file. Ex: <code class="prettyprint">echo &quot;Last line of text&quot; &gt;&gt; sometext.txt</code>. Merge files: <code class="prettyprint">cat append.txt &gt;&gt; main.txt</code> will put all the text in append.txt into main.txt. Overwrite: <code class="prettyprint">echo &quot;New contents of text file&quot;  &gt; whatevs.txt</code> will replace all text in the file with the text in quotes. Display text in file: <code class="prettyprint">cat showit.txt</code> will print the contents in the terminal window. Create: <code class="prettyprint">cat &gt; new.txt</code> will let you create a new text file in the terminal by typing lines (ctl-c to exit).</li>
<li><strong>less</strong> makes it so you can paginate and read a text tile. Ex: <code class="prettyprint">less longtext.txt</code> will fill the screen with the first part of the longtext.txt file. Use the space bar to view the next page. Type <code class="prettyprint">q</code> to exit.</li>
<li><strong>nano</strong> a text editor. You&rsquo;ll often see commands that call <code class="prettyprint">nano</code> so you can edit a configuration. Ex: <code class="prettyprint">nano /etc/avahi/services/afpd.service</code> to edit the avahi Apple file service file.</li>
<li><strong>find</strong> look for files in the filesystem. Ex: <code class="prettyprint">find ~/Documents -name particular.txt -type f</code> will look for the file with the name <code class="prettyprint">particular.txt</code> in the Documents directory.</li>
<li><strong>chmod</strong> change mode. Used for file permissions, which can be important when sharing things on the network, scripting actions, and many more reasons. </li>
<li><strong>htop</strong> display the processes currently alive on the CPU. If things seem slow, or you want to see how much CPU or memory a program is using, just type <code class="prettyprint">htop</code> to see a table of all running processes, then type <code class="prettyprint">q</code> when you want to exit.</li>
<li><strong>scp</strong> secure copy. copy a file from one computer to another over a network. Ex: <code class="prettyprint">scp Pictures/Vacation/motel.jpg Pictures/Vacation/accident.jpg chip@otherchip.local:~/Pictures</code> copies a couple jpegs to another computer on the network.</li>
<li><strong>ssh</strong> secure shell. access another computer on the network and use the terminal commands to make changes and control it. Ex: <code class="prettyprint">ssh chip@chip.local</code> to access your CHIP on a local network.</li>
<li><strong>CTRL C</strong> if you can&rsquo;t use the terminal because a process is taking too long, type CTRL-C on your keyboard to cancel the most recent command.</li>
</ul>

          <h1 id="connecting-accessories">Connecting Accessories</h1>

<p>CHIP has a lot of connectors, some for building, some for doing normal computer things. This section covers the normal computer things, like audio, video, and input.</p>

<h2 id="recommended-accessories">Recommended Accessories</h2>

<p>CHIP is a minimal computer. Many CHIP users may never connect common peripherals, instead using CHIP as a &ldquo;headless&rdquo; computer. 
Like desktop computers from Best Buy, you may find that certain accessories will improve the overal usability of CHIP. We recommend:</p>

<ul>
<li>Bluetooth Keyboard</li>
<li>USB mouse</li>
<li>Monitor with a composite video input</li>
<li>USB cable: USB-A to microUSB-B</li>
<li>TRRS to RCA connector</li>
<li>2A, 5V USB power supply</li>
</ul>

<p>Additionally, some of the advanced tutorials require:</p>

<ul>
<li>Speakers with RCA audio input</li>
<li>Jumper wire</li>
<li>USB to UART cable</li>
<li>Single cell Lithium Polymer battery</li>
</ul>

<h2 id="powered-usb-hub">Powered USB Hub</h2>

<p>You&rsquo;ll find that a simple powered USB hub is pretty essential if you want to use a lot of USB devices with CHIP. 
Not only is there only one USB port (keeping CHIP nice and small), but CHIP&rsquo;s micro USB power port can only provide so much power for the USB port. If you don&rsquo;t have a powered USB port, you&rsquo;ll quickly max out power if you attach too many accessories. </p>

<h2 id="keyboard-and-mouse">Keyboard and Mouse</h2>

<p>Many keyboards have USB hubs built-in, so you can attach a mouse to the keyboard, attach the keyboard to CHIP, and immediately have control. However, it&rsquo;s likely the two will draw too much current, so you&rsquo;ll want to connect to a powered hub before you connect.</p>

<p><img src="images/chip_usbconnections.jpg" alt="keyboard, mouse, and powered USB hub connected to CHIP" /></p>

<h2 id="bluetooth-keyboard-and-mouse">Bluetooth Keyboard and Mouse</h2>

<p>As you know, CHIP has built-in bluetooth. If you want to use a keyboard and mouse, you can keep your USB port free for other things (like mass storage or a MIDI controller!) and keep your desk clean. See <a href="#bluetooth">connecting to bluetooth section</a></p>

<h2 id="monitor">Monitor</h2>

<p>In the spirit of keeping things small, CHIP packs all the audio and video into a small TRRS (Tip-Ring-Ring-Sleeve) connector. Built-in video output is restricted to standard composite video resolution of 640x480. Higher video resolutions are possible using the <a href="https://getchip.com/pages/store">VGA and HMDI</a> DIP boards.</p>

<p><img src="images/chip_withmonitor.jpg" alt="monitor connected to CHIP" /></p>

<p>Here&rsquo;s what the other end of the cable looks like, attached to a monitor with stereo audio inputs (red and white) and the composite video plug, moved so you can see the label on the monitor:</p>

<p><img src="images/chip_withmonitor_cnxn.jpg" alt="monitor connected to CHIP" /></p>

<h3 id="about-the-trrs-connector">About the TRRS Connector</h3>

<p>CHIP has a 1/8&quot; (3.5mm) Tip-Ring-Ring-Sleeve (TRRS) output jack, capable of carrying stereo audio, and either composite video out, or microphone in.</p>

<p><img src="images/avcable.jpg" alt="Typical AV cable that carries stereo audio and composite video" /></p>

<p>This is a fairly common port, but there are a few different arrangements of the conductors, so not all cables are equal.  Fortunately, CHIP uses the same conductor arrangement as Pi, Zune, and iPod audio/video cables, so the most common &ldquo;mini to RCA A/V&rdquo; cables should work just fine.</p>

<p>Some cables will route signals a bit differently, using the Red RCA cable for Video instead of Yellow.  If video out isn&rsquo;t working through the yellow cable, see if red works.  If not, your cable may be a version that&rsquo;s arranged in a way that it just won&rsquo;t work with CHIP:</p>

<ul>
<li>yellow : video</li>
<li>red : stereo audio right channel</li>
<li>white : stereo audio left channel</li>
</ul>

<p>The conductors on the TRRS plug are arranged like this:</p>

<p><img src="images/trrs_annotated.jpg" alt="Tip: Audio Left, Ring: Audio Right, Ring: Ground, Sleeve: Video" /></p>

<p>If you want to learn even more about TRRS connectors and the general lack of standardization with them, <a href="http://wiki.robotz.com/index.php/TRRS_Phono_Plug">this page</a> has even more details.</p>

<h3 id="ntsc-or-pal">NTSC or PAL</h3>

<p>The composite video format is NTSC by default. If you need to hook up to a monitor that only uses a PAL signal, you&rsquo;ll need to change that at u-boot time.
First, connect to CHIP with a <a href="#usb-to-uart-serial-connection">UART cable</a>.
Then power up CHIP, and press a key on the keyboard to boot into u-boot mode to change the environment variable manually.</p>
<pre class="highlight shell"><code>printenv video-mode
setenv video-mode <span class="o">(</span>mode data<span class="o">)</span>
saveenv
reset
</code></pre>
<p>where <em>mode data</em> can be, for NTSC and PAL respectively:</p>
<pre class="highlight shell"><code>setenv video-mode sunxi:640x480-24@60,monitor<span class="o">=</span>composite-ntsc,overscan_x<span class="o">=</span>40,overscan_y<span class="o">=</span>20

setenv video-mode sunxi:720x576-24@50,monitor<span class="o">=</span>composite-pal,overscan_x<span class="o">=</span>40,overscan_y<span class="o">=</span>20

</code></pre>
<h2 id="headphones">Headphones</h2>

<p>The audio and video connector on CHIP can be dedicated to audio output suitable for headphones or connecting to an amplifier for filling a room or public space with glorious sound. 
Just connect a standard 3.5 mm (1/8&quot;) TRS audio plug into CHIP&rsquo;s a/v jack. Of course, if headphones are plugged in, there will be no room for a composite video output jack. You can also get audio left, common, and right output from <a href="#pin-headers">pins 4, 6 &amp; 8 on header U14</a>.</p>

<p><img src="images/chip_withaudio.jpg" alt="CHIP connected to headphones" /></p>

<h2 id="microphone-and-audio-input">Microphone and Audio Input</h2>

<p>If you want to use audio input, you might find it easiest to use the pins on <a href="#pin-headers">pins 10 and 12 on header U14</a>. However, if you want to use the 1/8&quot; TRRS connector, you can modify the CHIP board to replace the composite video connection with an audio input connection. </p>

<p>If you look at the bottom of CHIP with the audio and USB jacks pointed up, you&rsquo;ll see three small contact pads to the left of the audio jack. The left pad has a small label of <strong>mic</strong> and the right pad has a <strong>tv</strong> label. Between the middle pad and the <strong>tv</strong> pad is a trace that can be carefully cut with an Exacto or utility razor blade. Once that is cut (check with a volt or continuity meter), you can put a solder blob between the <strong>mic</strong> and middle pad. Now the outer ring can be used for audio input.</p>

<p><img src="images/chip_audioinbridge.jpg" alt="Slice video trace, bridge mic in pad" /></p>

<p>As another reference, if you had X-ray vision and you were looking from the <strong>bottom</strong> of CHIP, you&rsquo;d see a trace like this:</p>

<p><img src="images/chip_tvmonxray.jpg" alt="Xray vision of TV and Mic traces from top of CHIP" /></p>

<p>If the composite video connection is needed again, just reverse the process: desolder the connection between <strong>mic</strong> and the middle pad, then solder a bridge between <strong>tv</strong> and the middle pad.</p>

<h3 id="microphone-with-header-pins">Microphone with Header Pins</h3>

<p>If you want to use the <a href="#pin-headers">pins 10 and 12 on header U14</a>, you&rsquo;ll most likely need to add some additional circuitry to get a good input signal. Here is a schematic of the simple circuit:</p>

<p><img src="images/microphone_schematic.jpg" alt="Schematic for adding a microphone input to MIC pins on CHIP" /></p>

<p>You&rsquo;ll need two 4.7 microfarad capacitors, one 100 nanofarad capacitor, and a 3300 picofarad capacitor. You&rsquo;ll also need one 2 kilo-ohm and one 4.3 kilo-ohm resistors.</p>

<h2 id="usb-storage">USB Storage</h2>

<p>If you have files that you want to modify, use, or transfer to CHIP&rsquo;s internal storage, you can attach a USB thumb drive, card-reader, or hard drive. Open the file manager and access the files.</p>

<p><img src="images/chip_usbstorage.jpg" alt="USB drive attatched to CHIP" /></p>

<h2 id="usb-audio">USB Audio</h2>

<p>CHIP can use Class-compliant USB audio devices. A popular, and inexpensive choice for audio devices are USB dongles based on the C-Media chipset. These have been tested successfully with CHIP and can often be purchased for less than $10. Some good resources for linux and audio compatibility are on the <a href="http://wiki.linuxaudio.org/wiki/hardware_matrix">linux audio</a> and <a href="http://www.alsa-project.org/main/index.php/Matrix:Main">alsa project</a> websites.</p>

<p>Many of the drivers have not been tested with CHIP - as CHIP matures, more information will be available. For now, we recommened USB Class-compliant or &ldquo;plug-and-play&rdquo; audio devices.</p>

<h2 id="battery-and-charging">Battery and Charging</h2>

<p>Like any modern laptop, CHIP can run and charge any single-cell LiPo battery. Read more in the <a href="#power-up">powering CHIP section</a>.</p>

          <h1 id="using-the-chip-operating-system">Using The CHIP Operating System</h1>

<p>If you&rsquo;ve used a desktop or laptop computer before, the CHIP Operating System should be pretty familiar. There are menus, icons to click, menus with more stuff when you right-click, keyboard shortcuts, applications to run, and settings to set. CHIP is small, so we keep our operating system simple. Almost everything can be accessed from the <strong>Computer Things</strong> menu: settings, launching apps, and access to files. There&rsquo;s also a few convenient functions in the top right <strong>system tray.</strong> </p>

<h2 id="settings-and-configuration">Settings and Configuration</h2>

<p>Most of the settings for the computer and for the desktop can be set using the apps in the &ldquo;Computer Things&rdquo; menu. Select the appropriate app from either the Settings Menu or the Settings Manager.</p>

<p><img src="images/screen_settingsmenu.jpg" alt="Screenshot of GUI showing where to change WiFi settings" /></p>

<p><img src="images/screen_settingsmgr.jpg" alt="Screenshot of GUI showing where to change WiFi settings" /></p>

<h3 id="wifi">WiFi</h3>

<p>Connecting to a WiFi network is easy using the WiFi icon the top right system tray. Just select a network to initiate a connection. If you need a password, you&rsquo;ll be prompted for it.</p>

<p><img src="images/screen_wifisettings.jpg" alt="Select a wireless connection access point" /></p>

<p>If you need more control and information over your network connection, use the Settings-&gt;Network Connections panel to show your connections. Double click on a connection to bring up the connection editor:</p>

<p><img src="images/screen_networksettings.jpg" alt="Network connection editor" /></p>

<h3 id="bluetooth">Bluetooth</h3>

<p>Bluetooth device setup can be accessed using the Bluetooth icon in the top right system tray.</p>

<p><img src="images/screen_btsettings.jpg" alt="Bluetooth settings menu" /></p>

<p>When you begin a connection, you&rsquo;ll be guided through the necessary steps to connect to your device. For example, when you pair with a keyboard, you&rsquo;ll often be prompted for a code to enter to ensure a unique connection. Once you have paired a device, future connections will usually be automatic when the devices are in range and powered up.</p>

<p><img src="images/screen_btsetup01.jpg" alt="Bluetooth settings menu" /></p>

<p>You can manage, and also connect to, your devices using the the Bluetooth Devices panel, accessed from the Bluetooth system tray:</p>

<p><img src="images/screen_btdevices.jpg" alt="Bluetooth devices panel" /></p>

<h3 id="sound">Sound</h3>

<p>By default sound output comes from the built-in connector, served by the &ldquo;sunxi codec&rdquo; driver. If you want to change the volume, you can use the volume control in the top right system tray:</p>

<p><img src="images/screen_volumectl.jpg" alt="Desktop volume control" /></p>

<p>Or, open the Audio Mixer in the Multimedia category:</p>

<p><img src="images/screen_audiomixermenu.jpg" alt="Open Audio Mixer app in Multimedia category" /></p>

<p>Here, you can select the &ldquo;Playback&rdquo; category to change the volume:</p>

<p><img src="images/screen_audiosettings03.jpg" alt="Control panel for sound" /></p>

<p>If you don&rsquo;t see that control, just click on the &ldquo;Select Controls&rdquo; button and enable all controls:</p>

<p><img src="images/screen_audiosettings02.jpg" alt="Enable all controls for audio mixer" /></p>

<h3 id="display">Display</h3>

<p>Use the Settings-&gt;Display control panel to adjust the monitor&rsquo;s resolution and rotation settings:</p>

<p>If you want to customize the desktop image, icons, colors, and fonts, there are two different panels. The Appearance panel lets you select a theme to make instant changes for several properties.</p>

<p><img src="images/screen_desktopsettings04.jpg" alt="Change monitor settings with the Display control panel" /></p>

<p>The Desktop panel lets you customize images and colors, along with the behavior of menus.</p>

<p><img src="images/screen_desktopsettings01.jpg" alt="Change desktop look with Desktop panel" /></p>

<p>If you want to change the theme or the icon sets, you can search for these using the <a href="#synaptic-package-manager">Synaptic Package Manager</a>. Search for <code class="prettyprint">gtk2 themes</code> or <code class="prettyprint">icon sets</code>. There are also packages that can make it easy to find and configure themes, such as <code class="prettyprint">gtk-theme-config.</code> Similarly you can use the command line to search packages with <code class="prettyprint">apt-cache search gtk2 theme</code>.</p>

<h3 id="time-and-date">Time and Date</h3>

<p>Set the Time with the Orage Globaltime panel. This can be found in Accessories-&gt;Orage Globaltime or in Office-&gt;Orage Globaltime. Simply click the time to bring up the preferences panel. You can quickly view the date from the Orage Calendar in the Office menu.</p>

<p><img src="images/screencap_timesettings.jpg" alt="Orage Globaltime is used to set the time and date" /></p>

<h3 id="mouse-sensitivity">Mouse Sensitivity</h3>

<p>Mouse sensitivity is set for the default 640x480 resolution. If you are using CHIP with a higher resolution monitor, you may want to adjust the sensitivity of the mouse. You can get to the Mouse settings panel from <strong>Computer Things-&gt;Settings-&gt;Mouse and Touchpad</strong></p>

<p><img src="images/screen_mousepanel.jpg" alt="Screenshot of mouse configuration panel" /></p>

<h3 id="language-and-location">Language and Location</h3>

<p>CHIP&rsquo;s operating system comes with a default language of English. You can change the language and the location, but you&rsquo;ll need to use the terminal to do so. Use the &ldquo;Computer Things!&rdquo; menu to launch the Terminal Emulator. 
Then use the <a href="#apt-get"><code class="prettyprint">apt-get</code></a> command to install the language packs and run a simple program to configure your language and location:</p>
<pre class="highlight shell"><code>sudo apt-get update <span class="o">&amp;&amp;</span> sudo apt-get install locales <span class="o">&amp;&amp;</span> sudo dpkg-reconfigure locales <span class="o">&amp;&amp;</span> sudo locale-gen
</code></pre>
<p>You&rsquo;ll get a large menu to select locales. Use the arrow keys to scroll down and spacebar to mark your location with an [*]. It&rsquo;s advised that you choose the location marked <code class="prettyprint">UTF8</code>. Others are somewhat arcane edge cases! Hit return to continue.</p>

<p><img src="images/screen_set_locales.jpg" alt="Setting locales in ncurses ui" /></p>

<p>You can set the timezone with </p>
<pre class="highlight plaintext"><code>sudo dpkg-reconfigure tzdata
</code></pre>
<p><img src="images/screen_set_tzdata.jpg" alt="Setting timezone in ncurses ui" /></p>

<h2 id="launching-installed-apps">Launching Installed Apps</h2>

<p>CHIP comes prepackaged with many open-source applications to get you started. It&rsquo;s easy to launch an application. 
You can select an application from the &ldquo;Computer Things!&rdquo; menu and select an app from the categories:</p>

<p><img src="images/screen_appfinder01.jpg" alt="Screenshot of GUI launching apps" /></p>

<p>Or, for more control, launch the Application Finder in Accessories, where you can use the search bar and easily navigate among the categories:</p>

<p><img src="images/screen_appfinder02.jpg" alt="Screenshot of GUI launching apps" /></p>

<p>Below are some of the applications that come pre-installed with CHIP:</p>

<h3 id="abiword">AbiWord</h3>

<p>AbiWord is a fully featured word processor. You can learn more at <a href="http://www.abiword.org">The AbiWord website</a></p>

<p><img src="images/appscreen_abiword.jpg" alt="AbiWord can process words." /></p>

<h3 id="web-browser">Web Browser</h3>

<p>CHIP OS ships with the Ice Weasel browser. It is a Debian Linux version of the Firefox browser. 
The browser is largely the same as Firefox, just with a different name. 
More information is at the <a href="https://wiki.debian.org/Iceweasel">Debian website</a> and in this <a href="http://unix.stackexchange.com/questions/44215/is-there-any-advantage-of-using-iceweasel-and-firefox">stack exchange thread</a>.
If you update your system (either through Synaptic or the command <code class="prettyprint">apt-get update &amp;&amp; apt-get upgrade</code>, you will suddenly find that your browser is called Firefox. This change is documented on the <a href="https://wiki.debian.org/Iceweasel">debian wiki</a></p>

<p><img src="images/appscreen_webbrowser.jpg" alt="Browse the web with IceWeasel" /></p>

<h3 id="video-player">Video Player</h3>

<p>CHIP plays video! Use the built-in Mplayer to open and play videos.</p>

<p><img src="images/appscreen_videoplayer.jpg" alt="Mplayer plays video" /></p>

<h3 id="terminal-commandline">Terminal (commandline)</h3>

<p>The life blood of linux. If there&rsquo;s something you can&rsquo;t do on the desktop, or you want to automate tasks, or access different hardware settings using nothing but a keyboard and text, you&rsquo;ll open up Terminal.</p>

<p><img src="images/appscreen_terminal.jpg" alt="Terminal does even more computer things" /></p>

<h3 id="complete-list-of-installed-software">Complete List of Installed Software</h3>

<p>These are the applications installed by default on CHIP as accessed through the GUI.</p>

<ul>
<li>Application Finder</li>
<li>Bulk Rename</li>
<li>Leafpad</li>
<li>Orage Globaltime</li>
<li>Screenshot</li>
<li>Task Manager</li>
<li>Thuner File Manger</li>
<li>Xarchiver</li>
<li>Alex the Allegator 4</li>
<li>Spout</li>
<li>Viewnior</li>
<li>Ice Weasel Web Browser</li>
<li>Audio Mixer</li>
<li>GNOME MPlayer</li>
<li>QjackCtl</li>
<li>AbiWord</li>
<li>Atril Document Viewer</li>
<li>Gnumetric</li>
<li>Orange Calendar</li>
<li>Orage Globaltime</li>
<li>Htop</li>
<li>Package Updater</li>
<li>Synaptic Package Manager</li>
<li>Xfce Terminal</li>
<li>Notifications</li>
<li>Various System Settings</li>
<li>Zip (and UnZip)</li>
</ul>

<h2 id="install-and-update-software">Install and Update Software</h2>

<h3 id="synaptic-package-manager">Synaptic Package Manager</h3>

<p>Launch the Synaptic Package Manager to find and install new software. 
Synaptic is a graphical interface to the <code class="prettyprint">apt-get</code> command and will install software intended for DERP and other debain-based systems. You can learn more about Synaptic <a href="https://help.ubuntu.com/community/SynapticHowto">here</a></p>

<p>There&rsquo;s a simple search bar to make it easy to find packages you are interested in. If you don&rsquo;t find the package you are looking for, hit the <strong>Reload</strong> button to refresh Synaptic&rsquo;s record of available packages.</p>

<p><img src="images/appscreen_synaptic.jpg" alt="Install software with Synaptic" /></p>

<h3 id="example-installing-scratch-programming-environment">Example: Installing Scratch Programming Environment</h3>

<p>Using Synaptic is very easy. For example, if you wanted to install the Scratch Programming Environment, you can simply search for &ldquo;scratch&rdquo; and you&rsquo;ll get a lot of results. Scroll through, and you&rsquo;ll eventually find &ldquo;scratch&rdquo; in the packages window.
However, you&rsquo;ll probably want to narrow your results with better search terms, such as &ldquo;scratch programming environments&rdquo;</p>

<p><img src="images/screen_scratchsearch.jpg" alt="Search Synaptic for Scratch" /></p>

<p>When search is complete, you can select &ldquo;scratch&rdquo; from the package panel.</p>

<p><img src="images/screen_scratchfound.jpg" alt="Scratch package found" /></p>

<p>Press the top &ldquo;Apply&rdquo; button, and you&rsquo;ll get the following dialog:</p>

<p><img src="images/screen_instscratch_02.jpg" alt="Scratch package found" /></p>

<p>and you&rsquo;ll be notified of the progress:</p>

<p><img src="images/screen_instscratch_03.jpg" alt="Scratch installing" /></p>

<p>After a minute or so, you&rsquo;ll be notified that it&rsquo;s finished:</p>

<p><img src="images/screen_instscratch_04.jpg" alt="Scratch installed" /></p>

<p>Now that it&rsquo;s installed, you can launch scratch:</p>

<p><img src="images/screen_scratchinstalled.jpg" alt="Scratch installed" /></p>

<h3 id="auto-update">Auto Update</h3>

<p>CHIP will automatically look for any updates and alert you if updates are available for your existing software and the operating system.</p>

<h3 id="apt-get">apt-get</h3>

<p>If you are using the commandline, you will use <code class="prettyprint">apt-get</code> to install and update new software.</p>

<p>If you are new to apt, some important commands to know:</p>

<ul>
<li><code class="prettyprint">sudo apt-get update</code> updates the information from repositories, so any installs you make with <code class="prettyprint">install</code> will be the latest package</li>
<li><code class="prettyprint">sudo apt-get upgrade</code> upgrades any installed packages.</li>
<li><code class="prettyprint">sudo apt-get install (name of package)</code> to install a package and any of its dependencies.</li>
<li><code class="prettyprint">sudo apt-get remove (name of package)</code> will remove a package and any dependencies not used by other packages</li>
<li><code class="prettyprint">sudo apt-get purge  (name of package)</code> will remove a package and any dependencies not used by other packages along with all settings data</li>
<li><code class="prettyprint">apt-cache search (search terms)</code> will search through the package repositories for names and descriptions that include your search term.</li>
</ul>

<h2 id="uninstall-software">Uninstall Software</h2>

<p>You can use the Synaptic Package manager to uninstall any packages you no longer need.
If you know the name, you can use the Search function to find the package, then Mark it for Removal.</p>

<p>For example, if you want to remove AbiWord, first open Synaptic and search for &ldquo;<strong>abiword</strong>&rdquo;:</p>

<p><img src="images/screen_uninstall01.jpg" alt="Uninstall with Synaptic" /></p>

<p>Once found, select AbiWord in the package list, and select &ldquo;<strong>Mark for Removal</strong>&rdquo; in the Package menu:</p>

<p><img src="images/screen_uninstall03.jpg" alt="Uninstall with Synaptic" /></p>

<p>If there are additional, related packages that need to be removed, you&rsquo;ll be notified:</p>

<p><img src="images/screen_uninstall04.jpg" alt="Uninstall with Synaptic" /></p>

<p>Finally, press the top &ldquo;<strong>Apply</strong>&rdquo; menu to remove the packages:</p>

<p><img src="images/screen_uninstall05.jpg" alt="Uninstall with Synaptic" /></p>

<p>You&rsquo;ll be notified what changes will be applied:</p>

<p><img src="images/screen_uninstall06.jpg" alt="Uninstall with Synaptic" /></p>

<p>Finally, you can confirm that AbiWord has been removed by checking the Applications menu:</p>

<p><img src="images/screen_uninstall08.jpg" alt="Uninstall with Synaptic" /></p>

<h2 id="boot-into-console">Boot into Console</h2>

<p>If you want want CHIP to boot directly into a console, and not load the Desktop or Window manager GUIs, there are a couple options.
For the temporary case, you can open a terminal window and use the command </p>
<pre class="highlight shell"><code>sudo systemctl <span class="nb">set</span>-default multi-user.target
</code></pre>
<p>Next time you boot CHIP, it will not load the desktop or window environment, leaving you with command-line operation only.
If you wanted to return to booting into the GUI, you can use this command before you reboot:</p>
<pre class="highlight shell"><code>sudo systemctl <span class="nb">set</span>-default graphical.target
</code></pre>
<p>The other option is to run a linux distribution with no GUI installed. You may want to do this if you want to use commandline only and want to save some storage space. 
You can follow instructions to <a href="#flash-chip-firmware">flash CHIP</a> with buildroot, or Debian (with no GUI).</p>

          <h1 id="chip-hardware">CHIP Hardware</h1>

<p>At around 30 grams, CHIP is small, but it packs a lot of hardware on the PCB. Here&rsquo;s an overview of the connections and components.</p>

<h2 id="parts-and-pieces">Parts and Pieces</h2>

<p><img src="images/chip_top_annotated.jpg" alt="Callout graphic of chip parts on top" />
<img src="images/chip_bottom_annotated.jpg" alt="Callout graphic of chip parts on bottom" /></p>

<h2 id="wireless">Wireless</h2>

<h3 id="wifi">WiFi</h3>

<p>CHIP supports 802.11b/g/n using the built-in WiFi. </p>

<h3 id="bluetooth">Bluetooth</h3>

<p>CHIP supports the Bluetooth 4.0 LE standard using the built-in Bluetooth.</p>

<h2 id="physical-connectors">Physical Connectors</h2>

<p>CHIP is loaded with essential connectors for USB, serial, audio, video, and loads of IO on the pin headers.</p>

<h3 id="usb">USB</h3>

<p>The single USB port on CHIP is USB 2.0 compatible. It can provide up to 500mA of current, as is standard for USB ports on computers. If you need to provide more current, we recommend a powered USB hub. </p>

<h3 id="usb-on-the-go">USB On The Go</h3>

<p>The micro USB port is generally used to provide power for CHIP. However, since CHIP can be powered through the pin headers or a battery, this port can be used for different things. 
By default, connecting CHIP&rsquo;s micro USB to a computer will create a USB Serial connection, so you can access CHIP with a <code class="prettyprint">screen</code> or <code class="prettyprint">cu</code> session in a terminal. With Linux kernel modifications, it is possible to enable other modes, such as an Ethernet bridge.</p>

<h3 id="composite-video-and-stereo-audio">Composite Video and Stereo Audio</h3>

<p>The 1/8&quot; <a href="#about-the-trrs-connector">TRRS connector</a> provides composite video and stereo audio output. Headphones can be plugged in for audio only.</p>

<p>Audio Input uses the same connection on the TRRS connector as the composite video signal. If you want to make audio input active on the TRRS connector, you need to <a href="#microphone-and-audio-input">cut a circuit board trace</a>. This is not as permanent as it sounds, as it is easy to re-enable composite video out with a small amount of soldering.</p>

<h2 id="pin-headers">Pin Headers</h2>

<p>The Pin Headers provide a massive amount of connectivity, making CHIP a suitable platform for product development for physical computing and &ldquo;internet of things&rdquo; devices. Here&rsquo;s a basic diagram that labels all the pins:</p>

<p><img src="images/chip_pinouts.jpg" alt="CHIP pinout" /></p>

<table><thead>
<tr>
<th>U13L</th>
<th>U13R</th>
<th>U14L</th>
<th>U14R</th>
</tr>
</thead><tbody>
<tr>
<td>GND : ground</td>
<td>CHG-IN : 5V input (power and battery charge)</td>
<td>GND : ground</td>
<td>VCC-5V : 5V power</td>
</tr>
<tr>
<td>VCC-5V : 5V power</td>
<td>GND : ground</td>
<td>UART1-TX : UART serial transmit</td>
<td>HPL : audio out left</td>
</tr>
<tr>
<td>VCC-3V3 : 3V power</td>
<td>TS : analog temperature sensor input</td>
<td>UART1-RX : UART serial receive</td>
<td>HPCOM : audio out common ground</td>
</tr>
<tr>
<td>VCC-1V8 : 1.8 V power</td>
<td>BAT : LiPo battery</td>
<td>FEL : &ldquo;fel mode&rdquo;: connect to ground to put CHIP in fel mode for firmware</td>
<td>HPR : audio out right</td>
</tr>
<tr>
<td>TWI1-SDA : two-wire serial bus 1</td>
<td>PWRON : power on</td>
<td>VCC-3V3 : 3 volt power</td>
<td>MICM : mic mute</td>
</tr>
<tr>
<td>TWI1-SCK : two-wire serial bus 1</td>
<td>GND : ground</td>
<td>LRADC : low-res Analog-Digital Converter</td>
<td>MICIN1 : audio in</td>
</tr>
<tr>
<td>X1 : Resistive touchpanel input (touchscreen)</td>
<td>X2 : Resistive touchpanel input (touchscreen)</td>
<td>XIO-P0 : expander GPIO</td>
<td>XIO-P1 : expander GPIO pin 1</td>
</tr>
<tr>
<td>Y1 : Resistive touchpanel input</td>
<td>Y2 : Resistive touchpanel input (touchscreen)</td>
<td>XIO-P2 : expander GPIO pin 2</td>
<td>XIO-P3 : expander GPIO pin 3</td>
</tr>
<tr>
<td>LCD-D2 : RGB666 data</td>
<td>PWM0 : pulse width modulation (also used for LCD backlight dimming)</td>
<td>XIO-P4 : expander GPIO pi</td>
<td>XIO-P5 : expander GPIO pin 5</td>
</tr>
<tr>
<td>LCD-D4 : RGB666 data</td>
<td>LCD-D3 : RGB666 data</td>
<td>XIO-P6 : expander GPIO pin 6</td>
<td>XIO-P7 : expander GPIO pin 7</td>
</tr>
<tr>
<td>LCD-D6 : RGB666 data</td>
<td>LCD-D5 : RGB666 data</td>
<td>GND : ground</td>
<td>GND : ground</td>
</tr>
<tr>
<td>LCD-D10 : RGB666 data</td>
<td>LCD-D7 : RGB666 data</td>
<td>AP-EINT1 : Application Processor Interrupt</td>
<td>AP-EINT3 : Application Processor Interrupt pin, necessary for certain kinds of hardware-software interactions (keyboard expander, etc.)</td>
</tr>
<tr>
<td>LCD-D12 : RGB666 data</td>
<td>LCD-D11 : RGB666 data</td>
<td>TWI2-SDA : two-wire serial bus 2 (I2C)</td>
<td>TWI2-SCK(*) : two-wire serial bus 2 (I2C)</td>
</tr>
<tr>
<td>LCD-D14 : RGB666 data</td>
<td>LCD-D13 : RGB666 data</td>
<td>CSIPCK : CMOS serial interface</td>
<td>CSICK : CMOS serial interface, can be used for attaching a serial camera sensor</td>
</tr>
<tr>
<td>LCD-D18 : RGB666 data</td>
<td>LCD-D15 : RGB666 data</td>
<td>CSIHSYNC : CMOS serial interface</td>
<td>CSIVSYNC : CMOS sync</td>
</tr>
<tr>
<td>LCD-D20 : RGB666 data</td>
<td>LCD-D19 : RGB666 data</td>
<td>CSID0 : CMOS serial interface</td>
<td>CSID1 : CMOS serial interface</td>
</tr>
<tr>
<td>LCD-D22 : RGB666 data</td>
<td>LCD-D21 : RGB666 data</td>
<td>CSID2 : CMOS serial interface</td>
<td>CSID3 : CMOS serial interface</td>
</tr>
<tr>
<td>LCD-CLK : RGB666 clock</td>
<td>LCD-D23 : RGB666 data</td>
<td>CSID4 : CMOS serial interface</td>
<td>CSID5 : CMOS serial interface</td>
</tr>
<tr>
<td>LCD-VSYNC : vertical sync for LCD screen</td>
<td>LCD-HSYNC : horizontal sync for LCD</td>
<td>CSID6 : CMOS serial interface</td>
<td>CSID7 : CMOS serial interface</td>
</tr>
<tr>
<td>GND : ground</td>
<td>LCD-DE : RGB666 data</td>
<td>GND : ground</td>
<td>GND : ground</td>
</tr>
</tbody></table>

<p>(*)The XIO GPIO pins are provided by an I2C Expander at address 0x38 on the TWI bus 2, as such, this address is not available on bus 2.</p>

<h2 id="mechanical-drawing">Mechanical Drawing</h2>

<p><img src="images/chip_mechanical.jpg" alt="CHIP mechanical drawing" /></p>

<p>Our git repo for CHIP hardware has a <a href="https://github.com/NextThingCo/CHIP-Hardware/tree/master/CHIP%5Bv1_0%5D/C.H.I.P._Mechanical">mechanical drawing</a></p>

<h2 id="open-source-hardware-where-to-get-it">Open Source Hardware: Where To Get It</h2>

<p>CHIP is open source hardware. Here&rsquo;s where you can get all the data you need to make, modify, or learn about your own CHIP. Visit the <a href="https://github.com/NextThingCo/CHIP-Hardware">CHIP Hardware git repository</a>.</p>

<p><img src="images/chip_schematic.jpg" alt="Sample schematic of CHIP" /></p>

          <h1 id="making-stuff">Making Stuff</h1>

<p>CHIP is more than a cool, small, inexpensive computer. It&rsquo;s a complete system for building projects that require remote control, network connectivity, and physical interfacing with people and the environment.
CHIP&rsquo;s pin headers have all the connections to make this happen. An annotated diagram of the pin headers can be found in the <a href="#pin-headers">hardware section</a> of this manual.</p>

<h2 id="gpio">GPIO</h2>

<p>GPIO provides basic digital connections to the physical world to create physical products with CHIP. These pins can act as &lsquo;reads&rsquo; or &#39;writes&rsquo;, for example, to sense switch positions or turn an LED on or off. </p>

<p>CHIP&rsquo;s most easily available IO pins are the &ldquo;XIO&rdquo; pins on header U14. This is the &ldquo;GPIO eXpander&rdquo; that uses an I2C bus to create eight (8) convenient pins for GPIO. These use address <code class="prettyprint">0x38</code> on the TWI bus 2. Other pins are available for GPIO if more than eight are needed.</p>

<h3 id="read-and-write-from-command-line">Read and Write From Command Line</h3>

<p>CHIP has several General Purpose Input/Output (GPIO) pins available for you to build around. If you want to access them in a very primitive way, just to confirm their existence, here&rsquo;s some things to try.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>CHIP</li>
<li>Jumper Wire</li>
<li>LED</li>
<li>SSH or serial connection to CHIP or</li>
<li>Monitor and keyboard</li>
</ul>

<h3 id="how-you-see-gpio">How You See GPIO</h3>

<p>There are eight (8) GPIO pins always available for connecting CHIP to the sense-able world. If you orient CHIP with the USB connector pointed up, you&rsquo;ll find the GPIO pins in the middle of the right header, U14, Pins 13-20, labeled XIO-P0 to P7: </p>

<p><img src="images/chip_pinouts.jpg" alt="Pinout diagram for CHIP" /></p>

<h3 id="gpio-library">GPIO Library</h3>

<p>There is an excellent library for working with GPIO and CHIP&rsquo;s IO busses, made available by our wonderful community. Check out the <a href="https://github.com/xtacocorex/Adafruit_Python_GPIO">Adafruit_Python_GPIO</a> and the <a href="https://github.com/xtacocorex/CHIP_IO">CHIP_IO</a> libraries. These make it very easy to get started with making things with CHIP.</p>

<h3 id="kernel-4-3-vs-4-4-gpio-how-to-tell-the-difference">Kernel 4.3 vs 4.4 GPIO - How To Tell The Difference</h3>

<p>For various reasons related to the community nature of Linux development, the GPIO expander pin numbers are different between CHIP OS kernels 4.3 and 4.4. What follows is a very technical discussion of the GPIO access. If you just want to start making stuff and don&rsquo;t need low-level information, you might just want to skip this section and go straight to the <a href="#python-library">python library</a>.</p>

<p>If you are developing applications on CHIP that use GPIO pins and you would like consistent behavior between the kernel versions, you need to know how to find out the base value for the GPIO values. It may be enough for you to know that the GPIO expander pins start at <em>408</em> on 4.3, <em>1016</em> on 4.4.11, and <em>1013</em> on 4.4.13-ntc-mlc, <strong>however, it would be ideal to calculate this in your application to truly future-proof for future kernels.</strong> </p>

<p>If you look in the directory <code class="prettyprint">/sys/class/gpio</code>, you&rsquo;ll find two directories starting with <code class="prettyprint">gpio</code>: <code class="prettyprint">gpiochip0</code> and either <code class="prettyprint">gpiochip408</code> (4.3) or <code class="prettyprint">gpiochip1016</code> (4.4.11) or <code class="prettyprint">gpiochip1013</code> (4.4.13-ntc-mlc).</p>

<p>The <code class="prettyprint">408</code> or <code class="prettyprint">1016</code> or <code class="prettyprint">1013</code> are the bases for the expander pins. If you want to definitively find out what the base is using code, you should </p>
<pre class="highlight shell"><code>cat gpiochip<span class="k">*</span>/label
cat gpiochip<span class="k">*</span>/ngpio
cat gpiochip<span class="k">*</span>/base
</code></pre>
<p>The <code class="prettyprint">label</code> you are interested in is the value <code class="prettyprint">pcf8574a</code> which is the device that provides GPIO expansion. This provides the number of GPIO as returned by <code class="prettyprint">ngpio</code>. The first expander pin starts with the <code class="prettyprint">base</code> value. If you parse all these values and apply to your code, you can setup your application to be kernel-agnostic for GPIO access. </p>

<p>Here is a python script that demonstrates this <a href="https://gist.github.com/howientc/606545e0ff47e2cda61f14fca5c46eee">in a gist</a></p>

<p>Here is a bash script to compute the base (courtesy of <a href="https://bbs.nextthing.co/users?name=fordsfords">bbs user @fordsfords</a>)</p>
<pre class="highlight shell"><code><span class="nv">LABEL_FILE</span><span class="o">=</span><span class="sb">`</span>grep -l pcf8574a /sys/class/gpio/<span class="k">*</span>/<span class="k">*</span>label<span class="sb">`</span> <span class="nv">BASE_FILE</span><span class="o">=</span><span class="sb">`</span>dirname <span class="nv">$LABEL_FILE</span><span class="sb">`</span>/base 
<span class="nv">BASE</span><span class="o">=</span><span class="sb">`</span>cat <span class="nv">$BASE_FILE</span><span class="sb">`</span>
</code></pre>
<p>Finally, you can view a practical example of calcualting the &ldquo;xio base&rdquo; in the CHIP_IO library <a href="https://github.com/xtacocorex/CHIP_IO/blob/master/source/common.c#L148">common.c code</a>.</p>

<h3 id="how-the-system-sees-gpio">How The System Sees GPIO</h3>

<p>There is a <code class="prettyprint">sysfs</code> interface available for the GPIO. This just means you can access the GPIO states in a file-system-like manner. For example, you can reference XIO-P0 using this path:</p>
<pre class="highlight shell"><code>  /sys/class/gpio/gpio408/
</code></pre>
<p>The number is somewhat unfortunate, since the <code class="prettyprint">sysfs</code> names do not match the labels on our diagram! But is not too hard to translate. Pins XIO-P0 to P7 linearly map to <code class="prettyprint">gpio408</code> to <code class="prettyprint">gpio415</code> on kernel 4.3 and <code class="prettyprint">gpio1016</code> to <code class="prettyprint">gpio1023</code> on kernel 4.4.11. For kernel 4.4.13-ntc-mlc the range is <code class="prettyprint">gpio1013</code> to <code class="prettyprint">gpio1019</code>. See <a href="#kernel-4-3-vs-4-4-gpio-how-to-tell-the-difference">above</a> to learn more about that distinction.</p>

<h3 id="some-gpio-switch-action">Some GPIO Switch Action</h3>

<p>These lines of code will let us read values on pin XIO-P7. First, we tell the system we want to listen to this pin:</p>
<pre class="highlight shell"><code>    <span class="c">#4.3</span>
  sudo sh -c <span class="s1">'echo 415 &gt; /sys/class/gpio/export'</span>
  <span class="c">#4.4.11</span>
  sudo sh -c <span class="s1">'echo 1023 &gt; /sys/class/gpio/export'</span>
  <span class="c">#4.4.13-ntc-mlc</span>
  sudo sh -c <span class="s1">'echo 1019 &gt; /sys/class/gpio/export'</span>
</code></pre>
<p>View the mode of the pin. It should return “in”:</p>
<pre class="highlight shell"><code>    <span class="c">#4.3</span>
  cat /sys/class/gpio/gpio415/direction
  <span class="c">#4.4.11</span>
  cat /sys/class/gpio/gpio1023/direction
  <span class="c">#4.4.13-ntc-mlc</span>
  cat /sys/class/gpio/gpio1019/direction
</code></pre>
<p>Connect a jumper wire between Pin 20 (XIO-P7) and Pin 39 (GND). Now use this line of code to read the value:</p>
<pre class="highlight shell"><code>    <span class="c">#4.3</span>
  cat /sys/class/gpio/gpio415/value
  <span class="c">#4.4.11</span>
  cat /sys/class/gpio/gpio1023/value
  <span class="c">#4.4.13-ntc-mlc</span>
  cat /sys/class/gpio/gpio1019/value
</code></pre>
<h3 id="some-gpio-output">Some GPIO Output</h3>

<p>You could also change the mode of a pin from “in” to “out”</p>
<pre class="highlight shell"><code>    <span class="c">#4.3</span>
  sudo sh -c <span class="s1">'echo out &gt; /sys/class/gpio/gpio415/direction'</span>
  <span class="c">#4.4.11</span>
  sudo sh -c <span class="s1">'echo out &gt; /sys/class/gpio/gpio1023/direction'</span>
  <span class="c">#4.4.13-ntc-mlc</span>
  sudo sh -c <span class="s1">'echo out &gt; /sys/class/gpio/gpio1019/direction'</span>
</code></pre>
<p>Now that it&rsquo;s in output mode, you can write a value to the pin:</p>
<pre class="highlight shell"><code>    <span class="c">#4.3</span>
  sudo sh -c <span class="s1">'echo 1 &gt; /sys/class/gpio/gpio415/value'</span>
  <span class="c">#4.4.11</span>
  sudo sh -c <span class="s1">'echo 1 &gt; /sys/class/gpio/gpio1023/value'</span>
  <span class="c">#4.4.13-ntc-mlc</span>
  sudo sh -c <span class="s1">'echo 1 &gt; /sys/class/gpio/gpio1019/value'</span>
</code></pre>
<p>If you attach an LED to the pin and ground, the LED will illuminate according to your control messages.</p>

<h3 id="enough-io">Enough IO</h3>

<p>When you are done experimenting, you can tell the system to stop listening to the gpio pin:</p>
<pre class="highlight shell"><code>    <span class="c">#4.3</span>
  sudo sh -c <span class="s1">'echo 415 &gt; /sys/class/gpio/unexport'</span>
  <span class="c">#4.4.11</span>
  sudo sh -c <span class="s1">'echo 1023 &gt; /sys/class/gpio/unexport'</span>
  <span class="c">#4.4.13-ntc-mlc</span>
  sudo sh -c <span class="s1">'echo 1019 &gt; /sys/class/gpio/unexport'</span>
</code></pre>
<h3 id="learn-more">Learn More</h3>

<p>You can learn more about GPIO and Linux <a href="https://www.kernel.org/doc/Documentation/gpio/sysfs.txt">here:</a></p>

<h2 id="python-library">Python Library</h2>

<p>There is a well-maintained python library that works for 4.3 and 4.4 kernels available <a href="https://github.com/xtacocorex/CHIP_IO">here</a>. This is analogous to the RPi.GPIO library, but is designed for CHIP. It&rsquo;s an excellent place for quickly working with GPIO and PWM on CHIP.</p>

<h2 id="gpio-types">GPIO Types</h2>

<p>There are many types of sensors that can be used with GPIO:</p>

<h3 id="switches">Switches</h3>

<p>Switches provide on/off state input from the physical world to your computer. You can <a href="#some-gpio-switch-action">use the commandline interface</a> to listen to switch values. A python library was created for the <a href="https://github.com/NextThingCo/ChippyRuxpin">ChippyRuxpin project</a> if you need a higher-level example in python. </p>

<h3 id="leds">LEDs</h3>

<p>LEDs can be illuminated and turned off using the <a href="#some-gpio-output">commandline interface</a>. Refer to the <a href="https://github.com/NextThingCo/ChippyRuxpin">ChippyRuxpin project</a> on a good example on how to manipulate the commandline using python.</p>

<h3 id="relays">Relays</h3>

<p>Relays are special hardware bridges used to switch higher voltage electronics, protecting CHIP from the high voltages that would destroy it.  Using a relay board is programmatically no different from using switches.</p>

<h2 id="expanding-gpio">Expanding GPIO</h2>

<p>If you don&rsquo;t need to drive an LCD, you can use those pins for more, faster GPIO if you want to. 
These are the pins numbered 18-40 on U13 and 27-40 on U14 to act as GPIO to increase the number of available GPIO pins. </p>

<h3 id="finding-gpio-pin-names">Finding GPIO Pin Names</h3>

<p>The process for reading the pins using sysfs are the same as the <a href="#some-gpio-switch-action">documentation above</a>. You can calculate the Pin name using the <a href="https://github.com/NextThingCo/CHIP-Hardware/blob/master/CHIP%5Bv1_0%5D/CHIPv1_0-BOM-Datasheets/Allwinner%20R8%20Datasheet%20V1.2.pdf">Allwinner R8 Datasheet</a>, starting on page 18. </p>

<p>The letter index is a multiple of 32 (where A=0), and the number is an offset. For example PD4 is <code class="prettyprint">LCD_D4</code> so</p>
<pre class="highlight plaintext"><code>D=3
(32*3)+4 = 100
</code></pre>
<p>Therefore, listening to LCD_D4 in sysfs would begin with</p>
<pre class="highlight plaintext"><code>sudo sh -c 'echo 100 &gt; /sys/class/gpio/export'
</code></pre>
<h2 id="analog-to-digital-conversion">Analog to Digital Conversion</h2>

<p>Pin 9 on header U14 provides a link for low resolution analog to digital conversion (ADC). 
There is no driver for this link yet. ADC is used to read continuous sensors (temperature, pots, FSR, photoresistor, etc)</p>

<h2 id="1-wire">1 Wire</h2>

<p>Only available in CHIP OS 4.4 and above, the <a href="https://en.wikipedia.org/wiki/1-Wire">1 Wire serial protocol</a> data is accessible from the sysfs device. Find your one wire devices with</p>
<pre class="highlight shell"><code>ls /sys/bus/w1/devices/2<span class="k">*</span>/eeprom
</code></pre>
<p>The <code class="prettyprint">*</code> is there because your eeprom device will register a unique UUID number with C.H.I.P., so the <code class="prettyprint">ls</code> command will show you all available one wire devices.</p>

<h2 id="uart">UART</h2>

<p><a href="https://en.wikipedia.org/wiki/Universal_asynchronous_receiver/transmitter">UART</a> connections can be made using the UART connections on header U14. It allows serial connection which can be used to:</p>

<ul>
<li>Connect from another machine to <a href="#usb-to-uart-serial-connection">CHIP via remote serial console</a></li>
<li>Use CHIP to connect to a microcontroller or other peripheral which has a serial interface (see below).</li>
</ul>

<h3 id="serial-connection-to-a-microcontroller-or-other-peripheral">Serial connection to a microcontroller or other peripheral</h3>

<p>First stop <em>Getty</em> to avoid most shell stdin/stdout to interfere with UART. Yes most, saddly kernel messages will still go though and there is currently no way to stop them (and they may happen from time to time after boot):</p>

<p>$ sudo systemctl stop serial-getty@ttyS0.service</p>

<p>You may even disable completely that service so that it remains off after reboot but then you won&rsquo;t be able to use the serial console:</p>

<p>$ sudo systemctl mask serial-getty@ttyS0.service</p>

<p>You can then use UART as a standard serial port from <code class="prettyprint">/dev/ttyS0</code>. Below is a little sample experiment to test your UART port:</p>

<h4 id="example-usage">Example usage</h4>

<p>Connect UART Tx to Rx directly via a cable. So all outputs will come as inputs.</p>

<p>Install PySerial (we&rsquo;ll have to run our process as <code class="prettyprint">root</code> to get access to the port):</p>

<p>$ sudo pip install pyserial</p>

<p>Write this little script and save it for example as <code class="prettyprint">test.py</code>:</p>
<pre class="highlight python"><code>    <span class="kn">import</span> <span class="nn">serial</span>
    <span class="kn">import</span> <span class="nn">time</span>
    <span class="k">with</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s">'/dev/ttyS0'</span><span class="p">)</span> <span class="k">as</span> <span class="n">ser</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">([</span><span class="n">i</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">(</span><span class="n">ser</span><span class="o">.</span><span class="n">read</span><span class="p">())[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</code></pre>
<p>Finally let&rsquo;s run it:</p>
<pre class="highlight shell"><code>    <span class="nv">$ </span>sudo python test.py
    1
    2
    3
    ...
    99
</code></pre>
<h2 id="pwm">PWM</h2>

<p><a href="https://en.wikipedia.org/wiki/Pulse-width_modulation">Pulse Width Modulation</a> can be used to control
motors and other devices. It is possible to use GPIO pins to drive motors, but they generally are
not fast enough for robust and smooth control. PWM can be accessed through an <code class="prettyprint">sysfs</code> protocol.</p>

<h2 id="i2c">I2C</h2>

<p><a href="https://en.wikipedia.org/wiki/I%C2%B2C">I2C (Inter-Integrated Circuit)</a> can be accessed through
a <code class="prettyprint">sysfs</code> protocol using the debian i2c-tools. In the terminal, use</p>
<pre class="highlight shell"><code>sudo apt-get install i2c-tools
</code></pre>
<p>Note that the &ldquo;XIO GPIO&rdquo; pins are provided by an I2C expander at address 0x38 on the TWI bus 2, so that address cannot be used on bus 2.</p>

<h2 id="lcd-monitor-support">LCD Monitor Support</h2>

<p>Using the numerous LCD header pins, a color touchscreen panel can be directly implemented on CHIP.</p>

<h2 id="project-examples">Project Examples</h2>

<p>Projects coming soon!</p>

          <h1 id="flash-chip-with-an-os">Flash CHIP With an OS</h1>

<p>You might want (or need) to completely re-flash your CHIP with a different operating system. We&rsquo;ve made it really easy to do this by embedding the entire process in a browser-based application. Just hook CHIP up to your computer, fire up a browser, and flash your CHIP</p>

<h2 id="things-you-will-need">Things you will need</h2>

<ul>
<li>C.H.I.P.</li>
<li>Standard-USB to micro-USB connector</li>
<li>Thin Paper clip (a jumper wire works too)</li>
<li>Separate computer with <a href="https://www.google.com/chrome/browser/desktop/index.html">Chrome</a> or <a href="https://www.chromium.org/getting-involved/download-chromium">Chromium</a> browser</li>
</ul>

<h2 id="instructions">Instructions</h2>

<p>If you don&rsquo;t have the Google <a href="https://www.google.com/chrome/browser/desktop/index.html">Chrome</a> or the open-source <a href="https://www.chromium.org/getting-involved/download-chromium">Chromium</a> browser on your other computer, install it by following the preceding links.</p>

<p>Ok, good. Now that you have installed the browser, you can visit <a href="http://flash.getchip.com">flash.getchip.com</a> in Chrome or Chromium and follow all the instructions. If you are using a computer with USB3 ports, it&rsquo;s suggested that you attach a USB2-compliant hub and connect your CHIP to the hub, instead of directly to the USB3 port.</p>

<p>It&rsquo;s possible to run the entire operation online. There are also options for downloading the OS image to your computer&rsquo;s harddrive, then flashing your CHIP with no additional need for internet access.</p>

<h3 id="fel-mode">FEL mode</h3>

<p>Here is a photo (which may be clearer than the animation in the web flasher) which shows where to place your jumper wire or paper clip:</p>

<p><img src="images/uboot_fel_jumper.jpg" alt="CHIP with jumper wire attached" /></p>

<p><em>Note: this jumper needs to be present only when you connect CHIP to power</em>. If for some reason the wire becomes disconnected after you have powered CHIP, there is no problem or need to panic.</p>

<p>For more information on OS-specific issues, <a href="#web-flasher-os-specific-issues">see here</a>.</p>

<h2 id="the-sdk-way">The SDK Way</h2>

<p>You may not want to use the browser-based flashing procedure. If this is the case, or you need additional tools, you can flash using the <a href="#flash-chip-firmware">CHIP SDK</a></p>

<h2 id="web-flasher-os-specific-issues">Web Flasher OS-Specific Issues</h2>

<p>Before you try anything else, try using a different USB cable. Many cables are charging-only, or do not support high bandwidth and will cause flashing to fail.</p>

<h3 id="windows-specific">Windows-specific</h3>

<ul>
<li>You must install <a href="https://s3-us-west-2.amazonaws.com/getchip.com/extension/drivers/windows/InstallDriver2.exe">drivers</a> to be able to talk with C.H.I.P.</li>
<li>Reboot after installing drivers on previous versions (&lt;10) of Windows.</li>
</ul>

<p>Unfortunately, due to the nature of how Windows manages drivers, the flashing procedure will likely fail the first time you use it. When that happens, try completely closing and reopening your browser. Depending on your version of windows, this might happen twice, once when waiting for FEL, and then again waiting for Fastboot.</p>

<h4 id="troubleshooting-the-web-flasher">Troubleshooting The Web Flasher</h4>

<ul>
<li>Try using a USB2 port (USB3 ports have issues).</li>
<li>Try passing through a USB2 hub if using a USB3 port.</li>
<li>Try a different USB cable. They often are bad.</li>
<li>Try turning off antivirus software.</li>
<li>If you get stuck &ldquo;Waiting for Fastboot&rdquo; and the above options don&rsquo;t work, you should be able to install a &ldquo;headless no fastboot&rdquo; image. However, it will take quite a bit longer, and the Operating System won&rsquo;t have a GUI.</li>
</ul>

<h3 id="macos-specific">MacOS specific</h3>

<ul>
<li>There are some times where using USB3 ports will cause the flashing to fail. If you can, try using a USB2 port, not a USB3. Recent Macs have only USB3 ports. If you find yourself with a modern Mac, try using a USB2 hub in your USB3 port and plug C.H.I.P. into that.</li>
<li>If you get stuck &ldquo;Waiting for Fastboot&rdquo; and the above options don&rsquo;t work, you should be able to install a &ldquo;headless no fastboot&rdquo; image. However, it will take quite a bit longer, and the Operating System won&rsquo;t have a GUI.</li>
<li>OS X El Capitan has been known to have issue with the flashing process. If a new cable or USB2 hub does not work and you are able to, upgrade to macOS Sierra.</li>
</ul>

<h3 id="linux-specific">Linux-specific</h3>

<p>Linux requires permissions to write to C.H.I.P. when its plugged into your computer. Chrome (or Chromium) does not have these permissions, so you need to explicitly create them before you&rsquo;ll be able to use the <a href="#flash-chip-with-an-os">web flasher</a> .</p>

<h4 id="on-ubuntu">On Ubuntu:</h4>

<p>You need to paste the following into a terminal:</p>
<pre class="highlight shell"><code>sudo usermod -a -G dialout <span class="k">${</span><span class="nv">USER</span><span class="k">}</span>
sudo usermod -a -G plugdev <span class="k">${</span><span class="nv">USER</span><span class="k">}</span>

<span class="c"># Create udev rules</span>
<span class="nb">echo</span> -e <span class="s1">'SUBSYSTEM=="usb", ATTRS{idVendor}=="1f3a", ATTRS{idProduct}=="efe8", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip"
SUBSYSTEM=="usb", ATTRS{idVendor}=="18d1", ATTRS{idProduct}=="1010", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip-fastboot"
SUBSYSTEM=="usb", ATTRS{idVendor}=="1f3a", ATTRS{idProduct}=="1010", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip-fastboot"
SUBSYSTEM=="usb", ATTRS{idVendor}=="067b", ATTRS{idProduct}=="2303", GROUP="plugdev", MODE="0660" SYMLINK+="usb-serial-adapter"
'</span> | sudo tee /etc/udev/rules.d/99-allwinner.rules
sudo udevadm control --reload-rules
</code></pre>
<p>Then logout and log back in.</p>

<p>For the curious:</p>

<ul>
<li>${USER}: outputs your username</li>
<li>dialout: gives non-root access to serial connections</li>
<li>plugdev: allows non-root mounting with pmount</li>
</ul>

<p>The udev rules then map the usb device to the groups.</p>

<p>For more information, check <a href="https://wiki.debian.org/SystemGroups">the systems group page on debian.org</a>.</p>

<p><strong>USB3 Issues</strong>
   * If you have any issues, try using a USB2 port and not a USB3 one, or try using a USB2 hub in your USB3 port and plug C.H.I.P. into that.
   * If you get stuck &ldquo;Waiting for Fastboot&rdquo; and the above options do not work, you should be able to install a &ldquo;headless no fastboot&rdquo; image. However, it will take quite a bit longer, and the Operating System won&rsquo;t have a GUI.</p>

<p><strong>Caveat</strong>
In rare cases, you may have an issue with your <a href="http://askubuntu.com/questions/185274/how-can-i-disable-usb-autosuspend-for-a-specific-device">computer</a> putting C.H.I.P. into auto-suspend mode. Here is an example on how to fix this problem:</p>
<pre class="highlight shell"><code>apt-get install laptop-mode-tools
<span class="c">#### edit /etc/laptop-mode/conf.d/runtime-pm.conf, uncomment/change AUTOSUSPEND_RUNTIME_DEVID_BLACKLIST</span>
<span class="c">#### add all fel devices to the blacklist:</span>
<span class="nv">AUTOSUSPEND_RUNTIME_DEVID_BLACKLIST</span><span class="o">=</span><span class="s2">"1f3a:efe8"</span>
reboot
</code></pre>
          <h1 id="advanced">Advanced</h1>

<p>For those interested in building with a stripped-down version of an operating system, or looking to customize CHIP from the command line, we have several tutorials that describe how to setup CHIP with more depth.</p>

<h2 id="installing-c-h-i-p-sdk">Installing C.H.I.P. SDK</h2>

<p>CHIP-SDK has everything needed to develop software for C.H.I.P. Most importantly, if you want to load an operating system onto CHIP, the only supported way is to do this from a virtual machine. Given that the virtual machine runs Ubuntu, it&rsquo;s pretty safe to say that Ubuntu users can flash without the virtual machine.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>Computer running OS X 10.10+, Ubuntu 14.04+, or Windows 7+</li>
<li>At least 1 GB free RAM, up to 40 GB of disk space may be used</li>
<li>Software: VirtualBox, Vagrant, git, terminal</li>
</ul>

<h3 id="software-setup">Software Setup</h3>

<p>There are several required software pieces to get the CHIP SDK virtual machine running.</p>

<h4 id="install-virtualbox-and-extensions">Install VirtualBox and Extensions</h4>

<ul>
<li>Get the installer for <a href="https://www.virtualbox.org/wiki/Downloads">Virtual Box</a></li>
<li>Install the Oracle VM VirtualBox <a href="https://www.virtualbox.org/wiki/Downloads">Extension Pack</a>.</li>
<li>If you are using Windows, you need to add the VirtualBox installation directory to your PATH.</li>
<li>In case of an Ubuntu host: add your user to the vboxusers group!</li>
</ul>

<h4 id="install-vagrant">Install Vagrant</h4>

<p>Install Vagrant from the <a href="https://www.vagrantup.com/downloads.html">Vagrant site.</a>
Alternatively, if OS X, you can use the <a href="http://brew.sh/">homebrew</a> package manager:
brew install caskroom/cask/brew-cask
brew cask install vagrant</p>

<h4 id="install-git">Install Git</h4>

<p>Installation of Git depends on your operating system:</p>

<ul>
<li>Windows: <a href="https://git-scm.com/download/win">direct to download</a></li>
<li>Debian Linux: <code class="prettyprint">sudo apt-get install git</code></li>
<li>OS X homebrew: <code class="prettyprint">brew install git</code></li>
</ul>

<h3 id="clone-the-chip-sdk-repository-and-boot-the-virtual-machine">Clone the CHIP-SDK repository and boot the Virtual Machine</h3>

<p>Assuming you have <a href="http://www.chambaud.com/2013/07/08/adding-git-to-path-when-using-github-for-windows/">git in your PATH</a>, open up a terminal and type:</p>
<pre class="highlight shell"><code>git clone https://github.com/NextThingCo/CHIP-SDK
</code></pre>
<p>and start up the virtual machine:</p>
<pre class="highlight shell"><code><span class="nb">cd </span>CHIP-SDK
vagrant up
</code></pre>
<h3 id="login-to-virtual-machine">Login To Virtual Machine</h3>

<p>In the same shell on the host type the following:</p>
<pre class="highlight shell"><code> vagrant ssh
</code></pre>
<p>If everything went well you should see the following prompt:</p>
<pre class="highlight shell"><code>vagrant@vagrant-ubuntu-trusty-32:~<span class="err">$</span>
</code></pre>
<h4 id="all-the-commands-at-once">All The Commands At Once</h4>

<p>Here&rsquo;s all the commands in one place:</p>
<pre class="highlight shell"><code>git clone https://github.com/NextThingCo/CHIP-SDK
<span class="nb">cd </span>CHIP-SDK
vagrant up
vagrant ssh
</code></pre>
<p>Congratulations! Now you&rsquo;re ready to Flash a C.H.I.P. from your SDK!</p>

<h3 id="troubleshooting-flashing-from-the-sdk">Troubleshooting Flashing from the SDK</h3>

<p>Here are a few possible problems.</p>

<h4 id="shared-folder-out-of-sync">Shared Folder Out of Sync</h4>

<p>In case you run into trouble because the kernel in the VM was updated and the shared vagrant folder can no longer be mounted, update the guest additions by typing the following in the CHIP-SDK directory on the host:</p>
<pre class="highlight shell"><code>vagrant plugin install vagrant-vbguest
</code></pre>
<p>This <a href="http://kvz.io/blog/2013/01/16/vagrant-tip-keep-virtualbox-guest-additions-in-sync/">blog post</a> has some more tips on keeping additions in sync.</p>

<h4 id="invalid-state">Invalid State</h4>

<p>If you get an error like:</p>
<pre class="highlight shell"><code>error: The guest machine entered an invalid state <span class="k">while </span>waiting <span class="k">for </span>it to boot.
</code></pre>
<p>This probably means your version of VirtualBox needs updating and/or needs the Extension Pack. Update as necessary and try <code class="prettyprint">vagrant up</code> again.</p>

<h4 id="couldn-39-t-find-file">Couldn&rsquo;t Find File</h4>

<p>If you get the error:</p>
<pre class="highlight shell"><code>error: Couldn<span class="s1">'t open file /Volumes/Satellite/gitbins/CHIP-SDK/base
</span></code></pre>
<p>that means you didn&rsquo;t cd CHIP-SDK. Very basic, perhaps, but late nights sometimes need that bump!</p>

<h3 id="updating-the-chip-sdk-virtual-machine">Updating the CHIP-SDK Virtual Machine</h3>

<p>You may have been working with CHIP for a while now, and you want to updated your SDK. It&rsquo;s only slightly more involved than sync&#39;ing with the git repo; you have to update the virtual machine, too.</p>

<h4 id="requirements">Requirements</h4>

<ul>
<li>Computer running OS X 10.10+, Ubuntu 14.04+, or Windows 7+</li>
<li>Existing <a href="#installing-c-h-i-p-sdk">installation of CHIP-SDK</a></li>
</ul>

<h4 id="how-to-update">How To Update</h4>

<p>Just follow these steps:</p>

<p>On your host operating system, pull the latest changes from our Git repository:</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> ~/CHIP-SDK
  git pull
</code></pre>
<p>Make sure the virtual machine is shut down and update it:</p>
<pre class="highlight shell"><code>  vagrant halt
  vagrant provision
</code></pre>
<p>Now you can boot the virtual machine and ssh into it:</p>
<pre class="highlight shell"><code>  vagrant up
  vagrant ssh
</code></pre>
<p>Once you see the trusty prompt, your CHIP SDK virtual machine is ready to use:</p>
<pre class="highlight shell"><code>  vagrant@vagrant-ubuntu-trusty-32:~<span class="err">$</span>
</code></pre>
<h4 id="all-the-commands-at-once">All The Commands At Once</h4>

<p>Here&rsquo;s all the commands in one place:</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> ~/CHIP-SDK
  git pull
  vagrant halt
  vagrant provision
  vagrant up
  vagrant ssh
</code></pre>
<h2 id="flash-chip-firmware">Flash CHIP Firmware</h2>

<p>Now that the <a href="#installing-c-h-i-p-sdk">virtual machine and SDK</a> are running and configured, you can connect CHIP to your computer and give it an operating system. If you want to flash using a native Ubuntu installation, read how to <a href="#setup-ubuntu-for-flashing">prepare Ubuntu to flash</a></p>

<h4 id="prepare-chip-for-flashing">Prepare CHIP for Flashing</h4>

<p>Prepare CHIP with a jumper wire connecting Pin 7 and Pin 39 on header U14 (FEL pin and GND). Here&rsquo;s a reference image that labels the headers and pins:</p>

<p><img src="images/uboot_fel_jumper.jpg" alt="CHIP with jumper wire attached" /></p>

<p><em>Note: this jumper needs to be present only when you connect CHIP to power</em>. If for some reason the wire becomes disconnected after you have powered CHIP, there is no problem or need to panic.</p>

<p>Now connect CHIP to your computer with a <a href="https://commons.wikimedia.org/wiki/File:Micro_USB.jpg">micro-USB</a>-&gt;USB-A cable. The power LED will illuminate.</p>

<h4 id="option-1-flash-with-ntc-buildroot-os">Option 1: Flash With NTC Buildroot OS</h4>

<p>Buildroot is a lean operating system, and does not have a package manager to install software. You can add additional software before you flash CHIP by <a href="#customize-buildroot">customizing buildroot</a>. </p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> ~/CHIP-tools
  ./chip-update-firmware.sh -f
</code></pre>
<p>The <code class="prettyprint">-f</code> option means &ldquo;fastboot.&rdquo; If you have problems flashing, particularly on Windows or OS X, you can run <code class="prettyprint">./chip-update-firmware.sh</code> to disable fastboot flashing.</p>

<p>During flashing, the terminal will fill with messages.  If successful, you&rsquo;ll see C.H.I.P. run through a hardware test, with the answers being &lsquo;OK&rsquo;.  If C.H.I.P. is &#39;OK&rsquo;, you can remove the jumper wire. Here is a <a href="#buildroot-output">sample successful output</a>.</p>

<h4 id="option-2-flash-with-debian">Option 2: Flash With Debian</h4>

<p>If you want to flash CHIP with the debian OS with no window manager or GUI</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> ~/CHIP-tools
  ./chip-update-firmware.sh -d -f
</code></pre>
<p>The <code class="prettyprint">-f</code> option means &ldquo;fastboot.&rdquo; If you have problems flashing, particularly on Windows or OS X, you can disable fastboot by leaving off the -f option: <code class="prettyprint">./chip-update-firmware.sh -d</code>. Here is a <a href="#debian-output">sample successful output</a>.</p>

<h4 id="option-3-flash-with-chip-operating-system">Option 3: Flash With CHIP Operating System</h4>

<p>If you want to flash CHIP with the complete CHIP Operating System with a desktop manager and GUI:</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> ~/CHIP-tools
  ./chip-update-firmware.sh -d -b stable-gui -f
</code></pre>
<p>During flashing, the terminal will fill with messages. If successful, you&rsquo;ll see C.H.I.P. run through a hardware test, with the answers being &#39;OK&rsquo;.  If C.H.I.P. is &#39;OK&rsquo;, you can remove the jumper wire. Here is a <a href="#debian-output">sample successful output</a>. Because of filesize, the &ldquo;gui&rdquo; option must also include the <code class="prettyprint">-f</code> fastboot option. Windows and OS X are not yet supported as flashing hosts.</p>

<h4 id="connect-to-chip-and-do-something">Connect to CHIP and Do Something</h4>

<p>If everything went OK, you can now power up your CHIP again and connect via serial as a USB gadget:</p>
<pre class="highlight shell"><code>  screen /dev/ttyACM0 115200
</code></pre>
<p>You can login to CHIP as <code class="prettyprint">chip</code> or <code class="prettyprint">root</code> using the password <code class="prettyprint">chip</code>.</p>

<p>and even test the hardware:</p>
<pre class="highlight shell"><code>  sudo hwtest
</code></pre>
<h4 id="customize-buildroot">Customize Buildroot</h4>

<p>Buildroot is a tool for building and cross-compiling a linux distribution that only has what you need. Setting up buildroot requires either a <a href="chip.html#installing-c-h-i-p-sdk">virtual machine</a> or a computer running Ubuntu OS, <a href="#setup-ubuntu-for-flashing">setup for flashing</a>.</p>

<h5 id="modify-and-build">Modify and Build</h5>

<p><a href="https://github.com/NextThingCo/CHIP-buildroot">C.H.I.P.-buildroot</a> is used to build buildroot and the linux kernel. Its Makefile operates on a <code class="prettyprint">.config</code> file which specifies options to include in the build. The <code class="prettyprint">.config</code> lives in the repository&rsquo;s root, whereas the one for the linux kernel is: ./board/chip/linux.config/</p>

<p>First, clone the buildroot repot and create the default config file with:</p>
<pre class="highlight shell"><code>git clone https://github.com/NextThingCo/CHIP-buildroot
<span class="nb">cd </span>CHIP-buildroot
make chip_defconfig
</code></pre>
<p>This will copy the the <code class="prettyprint">chippro_defconfig</code> file as <code class="prettyprint">.config</code> in the root of the repository. Other default config targets for other hardware can be found in the <code class="prettyprint">config</code> subdirectory. You can, of course, create your own config files and use them later.</p>

<p>Customize the buildroot using </p>
<pre class="highlight shell"><code>make nconfig
</code></pre>
<p>For Linux (which will modify the linux.config under board/nextthing/chip/): </p>
<pre class="highlight shell"><code>make linux-nconfig
</code></pre>
<p>Now</p>
<pre class="highlight shell"><code>make
</code></pre>
<p>from the buildroot repository root. This will cross-compile linux/buildroot for C.H.I.P. Pro. The targets wind up in the ./output/images directory. If you make changes to your config files, you can just <code class="prettyprint">make</code> again without a <code class="prettyprint">make clean</code>. </p>

<p>This will take a while, maybe an hour. When finished, flash CHIP with the script:</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> ~/CHIP-tools
  <span class="nv">BUILDROOT_OUTPUT_DIR</span><span class="o">=</span>../CHIP-buildroot/output ./chip-fel-flash.sh
</code></pre>
<p>Unless you changed the users or passwords, you can login to CHIP as <code class="prettyprint">chip</code> or <code class="prettyprint">root</code> using the password <code class="prettyprint">chip</code>.</p>

<h5 id="buildroot-cheat-sheet">Buildroot Cheat Sheet</h5>

<p>Here&rsquo;s a very terse explanation of how the make commands work in CHIP-buildroot:</p>
<pre class="highlight shell"><code>CHIP-buildroot/
├── make chip_defconfig
│   ├── apply pre-existing chip-specific configuration to buildroot
│   └── apply pre-existing chip-specific configuration to kernel
├── make chippro_defconfig
│   ├── apply pre-existing chippro-specific configuration to buildroot
│   └── apply pre-existing chippro-specific configuration to kernel
├── make linux-nconfig
│   └── make realtime changes to currently applied kernel defconfig
└── make nconfig
    └── make realtime changes to currently applied buildroot defconfig
</code></pre>
<p>The <code class="prettyprint">defconfig</code> is a sort of macro that loads a suggested starting point for a buildroot OS, for packages (nconfig) and kernel (linux-nconfig).</p>

<p>Use <code class="prettyprint">make nconfig</code> to add packages for extending the capabilities, like you might with a package manager in debian.</p>

<p>The <code class="prettyprint">make linux_nconfig</code> command modifies the kernel for specific drivers or hardware additions.</p>

<h3 id="appendix">Appendix</h3>

<p>Sample outputs are provided in this appendix so you can more easily troubleshoot or proceed with confidence when flashing CHIP with firmware.</p>

<h4 id="buildroot-output">Buildroot Output</h4>

<p>Sample output from flashing Buildroot to CHIP looks like:</p>
<pre class="highlight shell"><code><span class="nv">ROOTFS_URL</span><span class="o">=</span>http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images
<span class="nv">BUILD</span><span class="o">=</span>71
<span class="nv">BR_URL</span><span class="o">=</span>http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images
<span class="nv">BR_BUILD</span><span class="o">=</span>71
/home/doge/gits/CHIP-tools/.firmware/images/rootfs.ubi exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/rootfs.ubi
MD5: 90315ca1fb8ff95fc6878ce8126bdf02
S3_MD5: 6d59af4a0f673e1d61147e4a06dd7ba8
md5sum differs
--2015-10-21 15:59:16--  http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/rootfs.ubi
Resolving opensource.nextthing.co.s3.amazonaws.com <span class="o">(</span>opensource.nextthing.co.s3.amazonaws.com<span class="o">)</span>... 54.231.176.13
Connecting to opensource.nextthing.co.s3.amazonaws.com <span class="o">(</span>opensource.nextthing.co.s3.amazonaws.com<span class="o">)</span>|54.231.176.13|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 54525952 <span class="o">(</span>52M<span class="o">)</span> <span class="o">[</span>binary/octet-stream]
Saving to: ‘/home/doge/gits/CHIP-tools/.firmware/images/rootfs.ubi’

100%[<span class="o">======================================</span>&gt;] 54,525,952  1.83MB/s   <span class="k">in </span>29s

2015-10-21 15:59:45 <span class="o">(</span>1.82 MB/s<span class="o">)</span> - ‘/home/doge/gits/CHIP-tools/.firmware/images/rootfs.ubi’ saved <span class="o">[</span>54525952/54525952]

/home/doge/gits/CHIP-tools/.firmware/images/sun5i-r8-chip.dtb exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/sun5i-r8-chip.dtb
MD5: de0beb674eeb382901251febfbf1cf9b
S3_MD5: de0beb674eeb382901251febfbf1cf9b
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/sunxi-spl.bin exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/sunxi-spl.bin
MD5: dd3f9c9c0984a6c1d7cdca2921f6f448
S3_MD5: dd3f9c9c0984a6c1d7cdca2921f6f448
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/uboot-env.bin exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/uboot-env.bin
MD5: 6f2b79a781f9f490911012ec3aa653e9
S3_MD5: 6f2b79a781f9f490911012ec3aa653e9
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/zImage exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/zImage
MD5: 0d35ad764564a2cee9281715823597a2
S3_MD5: 0d35ad764564a2cee9281715823597a2
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/u-boot-dtb.bin exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/buildroot/stable/71/images/u-boot-dtb.bin
MD5: 97340d221bcbcc8f0bf27e26adc26f0a
S3_MD5: 97340d221bcbcc8f0bf27e26adc26f0a
file already downloaded
BUILDROOT_OUTPUT_DIR <span class="o">=</span> /home/doge/gits/CHIP-tools/.firmware
<span class="o">==</span> preparing images <span class="o">==</span>
/home/doge/gits/CHIP-tools/spl-image-builder -d -r 3 -u 4096 -o 1664 -p 16384 -c 1024 -s 64 /home/doge/gits/CHIP-tools/.firmware/images/sunxi-spl.bin /tmp/chipflashqVYEIs/sunxi-padded-spl
<span class="nv">filesize</span><span class="o">=</span> 3573504
<span class="nv">PADDED_SPL_SIZE</span><span class="o">=</span>0x000000c6
35+1 records <span class="k">in
</span>36+0 records out
589824 bytes <span class="o">(</span>590 kB<span class="o">)</span> copied, 0.00082507 s, 715 MB/s
12+0 records <span class="k">in
</span>12+0 records out
196608 bytes <span class="o">(</span>197 kB<span class="o">)</span> copied, 0.0176519 s, 11.1 MB/s
Image Name:   flash CHIP
Created:      Wed Oct 21 15:59:46 2015
Image Type:   ARM Linux Script <span class="o">(</span>uncompressed<span class="o">)</span>
Data Size:    736 Bytes <span class="o">=</span> 0.72 kB <span class="o">=</span> 0.00 MB
Load Address: 00000000
Entry Point:  00000000
Contents:
   Image 0: 728 Bytes <span class="o">=</span> 0.71 kB <span class="o">=</span> 0.00 MB
<span class="o">==</span> upload the SPL to SRAM and execute it <span class="o">==</span>
waiting <span class="k">for </span>fel...OK
<span class="o">==</span> upload spl <span class="o">==</span>
<span class="o">==</span> upload u-boot <span class="o">==</span>
<span class="o">==</span> upload u-boot script <span class="o">==</span>
<span class="o">==</span> upload ubi <span class="o">==</span>
<span class="gp">100% </span><span class="o">[============================================================]</span>
<span class="o">==</span> execute the main u-boot binary <span class="o">==</span>
<span class="o">==</span> write ubi <span class="o">==</span>
flashing................OK
login... OK
password... OK
poweroff... OK
</code></pre>
<h4 id="debian-output">Debian Output</h4>

<p>Sample output from a successful Debian output:</p>
<pre class="highlight shell"><code>debian selected
<span class="nv">ROOTFS_URL</span><span class="o">=</span>http://opensource.nextthing.co.s3.amazonaws.com/chip/debian/stable/37
<span class="nv">BUILD</span><span class="o">=</span>37
<span class="nv">BR_URL</span><span class="o">=</span>http://opensource.nextthing.co/chip/buildroot/stable/71/images
<span class="nv">BR_BUILD</span><span class="o">=</span>71
/home/doge/gits/CHIP-tools/.firmware/images/rootfs.ubi exists... comparing to http://opensource.nextthing.co.s3.amazonaws.com/chip/debian/stable/37/rootfs.ubi
MD5: 6d59af4a0f673e1d61147e4a06dd7ba8
S3_MD5: 90315ca1fb8ff95fc6878ce8126bdf02
md5sum differs
--2015-10-21 16:06:36--  http://opensource.nextthing.co.s3.amazonaws.com/chip/debian/stable/37/rootfs.ubi
Resolving opensource.nextthing.co.s3.amazonaws.com <span class="o">(</span>opensource.nextthing.co.s3.amazonaws.com<span class="o">)</span>... 54.231.160.10
Connecting to opensource.nextthing.co.s3.amazonaws.com <span class="o">(</span>opensource.nextthing.co.s3.amazonaws.com<span class="o">)</span>|54.231.160.10|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 245366784 <span class="o">(</span>234M<span class="o">)</span> <span class="o">[</span>binary/octet-stream]
Saving to: ‘/home/doge/gits/CHIP-tools/.firmware/images/rootfs.ubi’

100%[<span class="o">======================================</span>&gt;] 245,366,784 1.27MB/s   <span class="k">in </span>2m 11s

2015-10-21 16:08:48 <span class="o">(</span>1.78 MB/s<span class="o">)</span> - ‘/home/doge/gits/CHIP-tools/.firmware/images/rootfs.ubi’ saved <span class="o">[</span>245366784/245366784]

/home/doge/gits/CHIP-tools/.firmware/images/sun5i-r8-chip.dtb exists... comparing to http://opensource.nextthing.co/chip/buildroot/stable/71/images/sun5i-r8-chip.dtb
MD5: de0beb674eeb382901251febfbf1cf9b
S3_MD5: de0beb674eeb382901251febfbf1cf9b
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/sunxi-spl.bin exists... comparing to http://opensource.nextthing.co/chip/buildroot/stable/71/images/sunxi-spl.bin
MD5: dd3f9c9c0984a6c1d7cdca2921f6f448
S3_MD5: dd3f9c9c0984a6c1d7cdca2921f6f448
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/uboot-env.bin exists... comparing to http://opensource.nextthing.co/chip/buildroot/stable/71/images/uboot-env.bin
MD5: 6f2b79a781f9f490911012ec3aa653e9
S3_MD5: 6f2b79a781f9f490911012ec3aa653e9
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/zImage exists... comparing to http://opensource.nextthing.co/chip/buildroot/stable/71/images/zImage
MD5: 0d35ad764564a2cee9281715823597a2
S3_MD5: 0d35ad764564a2cee9281715823597a2
file already downloaded
/home/doge/gits/CHIP-tools/.firmware/images/u-boot-dtb.bin exists... comparing to http://opensource.nextthing.co/chip/buildroot/stable/71/images/u-boot-dtb.bin
MD5: 97340d221bcbcc8f0bf27e26adc26f0a
S3_MD5: 97340d221bcbcc8f0bf27e26adc26f0a
file already downloaded
BUILDROOT_OUTPUT_DIR <span class="o">=</span> /home/doge/gits/CHIP-tools/.firmware
<span class="o">==</span> preparing images <span class="o">==</span>
/home/doge/gits/CHIP-tools/spl-image-builder -d -r 3 -u 4096 -o 1664 -p 16384 -c 1024 -s 64 /home/doge/gits/CHIP-tools/.firmware/images/sunxi-spl.bin /tmp/chipflashUooSfo/sunxi-padded-spl
<span class="nv">filesize</span><span class="o">=</span> 3573504
<span class="nv">PADDED_SPL_SIZE</span><span class="o">=</span>0x000000c6
35+1 records <span class="k">in
</span>36+0 records out
589824 bytes <span class="o">(</span>590 kB<span class="o">)</span> copied, 0.00181383 s, 325 MB/s
12+0 records <span class="k">in
</span>12+0 records out
196608 bytes <span class="o">(</span>197 kB<span class="o">)</span> copied, 0.0164913 s, 11.9 MB/s
Image Name:   flash CHIP
Created:      Wed Oct 21 16:08:49 2015
Image Type:   ARM Linux Script <span class="o">(</span>uncompressed<span class="o">)</span>
Data Size:    736 Bytes <span class="o">=</span> 0.72 kB <span class="o">=</span> 0.00 MB
Load Address: 00000000
Entry Point:  00000000
Contents:
   Image 0: 728 Bytes <span class="o">=</span> 0.71 kB <span class="o">=</span> 0.00 MB
<span class="o">==</span> upload the SPL to SRAM and execute it <span class="o">==</span>
waiting <span class="k">for </span>fel...OK
<span class="o">==</span> upload spl <span class="o">==</span>
<span class="o">==</span> upload u-boot <span class="o">==</span>
<span class="o">==</span> upload u-boot script <span class="o">==</span>
<span class="o">==</span> upload ubi <span class="o">==</span>
<span class="gp">100% </span><span class="o">[============================================================]</span>
<span class="o">==</span> execute the main u-boot binary <span class="o">==</span>
<span class="o">==</span> write ubi <span class="o">==</span>
flashing...........................OK
login... OK
password... OK
poweroff... OK
</code></pre>
<h4 id="failure">Failure</h4>

<p>There are a couple common errors that occur when flashing.</p>

<p>The first is a that CHIP is not in <code class="prettyprint">fel</code> mode, ready to receive firmware. There are three possible reasons for this:</p>

<ul>
<li>You already successfully flashed CHIP, and haven&rsquo;t disconnected the USB cable from your computer.</li>
<li>The jumper wire between Pins 7 &amp; 39 is either not present, loose, or the jumper is in the wrong holes.</li>
<li>There is a problem with the USB cable.</li>
</ul>

<p>You&rsquo;ll know this is the problem when you see this error in the terminal window:</p>
<pre class="highlight shell"><code><span class="o">==</span> upload the SPL to SRAM and execute it <span class="o">==</span>
ERROR: Allwinner USB FEL device not found!
<span class="o">==</span> upload images <span class="o">==</span>
ERROR: Allwinner USB FEL device not found!
ERROR: Allwinner USB FEL device not found!
ERROR: Allwinner USB FEL device not found!
ERROR: Allwinner USB FEL device not found!
<span class="o">==</span> execute the main u-boot binary <span class="o">==</span>
ERROR: Allwinner USB FEL device not found!
</code></pre>
<p>The other common error is that you need to run the <strong>chip-update-firmware.sh</strong> script with <strong>sudo</strong> (or you need to add a rules file as described in the next section). This error looks like this in your terminal window:</p>
<pre class="highlight shell"><code>Image 0: 848 Bytes <span class="o">=</span> 0.83 kB <span class="o">=</span> 0.00 MB
<span class="o">==</span> upload the SPL to SRAM and execute it <span class="o">==</span>
ERROR: You don<span class="s1">'t have permission to access Allwinner USB FEL device
== upload images ==
ERROR: You don'</span>t have permission to access Allwinner USB FEL device
ERROR: You don<span class="s1">'t have permission to access Allwinner USB FEL device
ERROR: You don'</span>t have permission to access Allwinner USB FEL device
ERROR: You don<span class="s1">'t have permission to access Allwinner USB FEL device
== execute the main u-boot binary ==
ERROR: You don'</span>t have permission to access Allwinner USB FEL device
</code></pre>
<h4 id="option-flash-without-sudo">Option: Flash Without sudo</h4>

<p>As a developer, there&rsquo;s a good chance you&rsquo;ll flash CHIP more than once in your life. You&rsquo;ll probably want to follow these steps.
In order to be able to run the <strong>chip-update-firmware.sh</strong> script without sudo, make a rules file:</p>
<pre class="highlight shell"><code>sudo touch /etc/udev/rules.d/99-allwinner.rules
</code></pre>
<p>and add the content with the tee command:</p>
<pre class="highlight shell"><code><span class="nb">echo</span> <span class="s1">'SUBSYSTEM=="usb", ATTRS{idVendor}=="1f3a", ATTRS{idProduct}=="efe8", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip"'</span> | sudo tee /etc/udev/rules.d/99-allwinner.rules
</code></pre>
<p>then, to make this rules file work:
<code class="prettyprint">shell
  sudo udevadm control --reload-rules
</code></p>

<h2 id="setup-ubuntu-for-flashing">Setup Ubuntu For Flashing</h2>

<p>If you are running Ubuntu OS on your computer, and don&rsquo;t want to bother with a virtual machine, you can flash CHIP from your real computer. A generous member of our forums created a script that duplicates the below steps in a convenient package. You can get it <a href="https://github.com/techgeeksid/chip-Flash-tool">from github</a>. Please note that this is not supported or maintained by Next Thing - we only link to it here for your potential convenience.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>Computer running Ubuntu 14.04+</li>
<li>Jumper wire</li>
<li>CHIP</li>
</ul>

<h3 id="install-dependencies">Install Dependencies</h3>

<p>Install some tools:</p>
<pre class="highlight shell"><code>sudo apt-get update
sudo apt-get install u-boot-tools android-tools-fastboot git build-essential curl android-tools-fsutils libusb-1.0-0-dev pkg-config
</code></pre>
<p>If you get an error that &ldquo;the repository android-tools-fastboot can&rsquo;t be found&rdquo;, you are probably booting from an Ubuntu Live CD (or USB stick). You&rsquo;ll need to add a repository so you can install the android-tools-fastboot:</p>
<pre class="highlight shell"><code>sudo add-apt-repository universe <span class="o">&amp;&amp;</span> sudo apt-get update
sudo apt-get install u-boot-tools android-tools-fastboot git build-essential curl android-tools-fsutils libusb-1.0-0-dev pkg-config
</code></pre>
<p>If you intend to customize buildroot with additional software, install these packages:</p>
<pre class="highlight shell"><code>  sudo apt-get install libncurses5-dev libc6-i386 lib32stdc++6 lib32z1
</code></pre>
<p>Get and make the fel tools:</p>
<pre class="highlight shell"><code>git clone http://github.com/NextThingCo/sunxi-tools
<span class="nb">cd </span>sunxi-tools
make
sudo rm -f /usr/local/bin/fel
sudo ln -s <span class="nv">$PWD</span>/fel /usr/local/bin/fel
</code></pre>
<p>Clone the CHIP-tools repository</p>
<pre class="highlight shell"><code><span class="nb">cd</span> ..
git clone http://github.com/NextThingCo/CHIP-tools
<span class="nb">cd </span>CHIP-tools
</code></pre>
<p>If you have already cloned the CHIP-tools from a previous CHIP flashing, you can, of course, just update your existing repository</p>
<pre class="highlight shell"><code><span class="nb">cd </span>CHIP-tools
git pull
</code></pre>
<p>You&rsquo;ll also need to add your user to some groups and add a udev rule</p>
<pre class="highlight shell"><code>sudo usermod -a -G dialout <span class="nv">$USER</span> <span class="o">&amp;&amp;</span>
sudo usermod -a -G plugdev <span class="nv">$USER</span> <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> -e <span class="s1">'SUBSYSTEM=="usb", ATTRS{idVendor}=="1f3a", ATTRS{idProduct}=="efe8", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip"
SUBSYSTEM=="usb", ATTRS{idVendor}=="18d1", ATTRS{idProduct}=="1010", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip-fastboot"
SUBSYSTEM=="usb", ATTRS{idVendor}=="1f3a", ATTRS{idProduct}=="1010", GROUP="plugdev", MODE="0660" SYMLINK+="usb-chip-fastboot"
SUBSYSTEM=="usb", ATTRS{idVendor}=="067b", ATTRS{idProduct}=="2303", GROUP="plugdev", MODE="0660" SYMLINK+="usb-serial-adapter"
'</span> | sudo tee /etc/udev/rules.d/99-allwinner.rules
</code></pre>
<p>Now you are ready to <a href="#flash-chip-firmware">flash CHIP</a> with firmware.</p>

<p>Note, if you are using openSUSE, you have to change the GROUP to &#39;lp&rsquo;.</p>

<h4 id="all-the-commands-at-once">All The Commands At Once</h4>

<p>Here&rsquo;s all the commands in one place:</p>
<pre class="highlight shell"><code>sudo apt-get update
sudo apt-get install u-boot-tools android-tools-fastboot git build-essential libusb-1.0-0-dev libncurses5-dev libc6-i386 lib32stdc++6 lib32z1 android-tools-fsutils
git clone http://github.com/NextThingCo/sunxi-tools
<span class="nb">cd </span>sunxi-tools
make
sudo rm -f /usr/local/bin/fel
sudo ln -s <span class="nv">$PWD</span>/fel /usr/local/bin/fel
<span class="nb">cd</span> ..
git clone http://github.com/NextThingCo/CHIP-tools
<span class="nb">cd </span>CHIP-tools
</code></pre>
<h2 id="wifi-connection">WiFi Connection</h2>

<p>Below are detailed instructions for connecting to Wi-Fi networks using two different command line protocols: <code class="prettyprint">nmcli</code> and <code class="prettyprint">connman</code>. If you are using the CHIP OS that comes installed on CHIP, or you have flashed with our Debian distribution, you&rsquo;ll want to use the first section about connecting with <code class="prettyprint">nmcli</code>. If you have flashed CHIP with our buildroot OS, you&rsquo;ll need to use <code class="prettyprint">connman</code>.</p>

<h3 id="connecting-c-h-i-p-to-wi-fi-with-nmcli">Connecting C.H.I.P. to Wi-Fi with nmcli</h3>

<p>There are several tools in Linux for connecting and configuring networks. We will be using the command nmcli (Network Manager Client). You may see other tutorials that reference iw or iwconfig, however, these tools are not recommended for C.H.I.P. You can read more about nmcli on the internet.</p>

<h4 id="requirements">Requirements</h4>

<p>You will need one of these scenarios:</p>

<ul>
<li>CHIP with monitor and keyboard attached</li>
<li><a href="#headless-chip">SSH or serial</a> connection</li>
<li>Wireless access to internet</li>
<li>CHIP loaded with CHIP OS or Debian</li>
</ul>

<h4 id="step-1-list-available-wi-fi-networks">Step 1: List available Wi-Fi networks</h4>

<p>In the terminal, type</p>
<pre class="highlight shell"><code>nmcli device wifi list
</code></pre>
<p>The output will list available access points</p>
<pre class="highlight shell"><code><span class="k">*</span>  SSID      MODE   CHAN  RATE       SIGNAL  BARS  SECURITY
<span class="k">*</span>  NextThing HQ    Infra  11    54 Mbit/s  100     ▂▄▆█  --
   NextThing Shop  Infra  6     54 Mbit/s  30      ▂___  WPA1 WPA2
   2WIRE533        Infra  10    54 Mbit/s  44      ▂▄__  WPA1 WPA2
</code></pre>
<h4 id="step-2-connect-to-a-network">Step 2: Connect to a network</h4>

<p>You can connect to password -protected or open access points.</p>

<h5 id="a-no-password">A: No Password</h5>

<p>To connect to an open network with no password, use this command:</p>
<pre class="highlight shell"><code>sudo nmcli device wifi connect <span class="s1">'(your wifi network name/SSID)'</span> ifname wlan0
</code></pre>
<p>These commands will respond with information about the connection.</p>

<h5 id="b-password-protected">B: Password Protected</h5>

<p>To connect to a password protected network, use this command, inserting your own network name and password:</p>
<pre class="highlight shell"><code>sudo nmcli device wifi connect <span class="s1">'(your wifi network name/SSID)'</span> password <span class="s1">'(your wifi password)'</span> ifname wlan0
</code></pre>
<h5 id="c-hidden-ssid-and-password-protected">C: Hidden SSID and Password Protected</h5>

<p>To connect to a hidden network, append <code class="prettyprint">hidden yes</code> to the command, after <code class="prettyprint">ifname wlan0</code></p>

<h4 id="step-3-test-your-connection">Step 3: Test your Connection</h4>

<p>You can verify and test your wireless network connection.</p>

<h5 id="verify">Verify</h5>

<p>You can verify your connection using the command</p>
<pre class="highlight shell"><code>nmcli device status
</code></pre>
<p>which outputs a list of the various network devices and their connections. For example, a successful connection would look like this:</p>
<pre class="highlight shell"><code>DEVICE   TYPE      STATE         CONNECTION
wlan0    wifi      connected     NextThing HQ
wlan1    wifi      disconnected  --
ip6tnl0  ip6tnl    unmanaged     --
lo       loopback  unmanaged     --
sit0     sit       unmanaged     --
</code></pre>
<p>Because it is worth knowing that Linux offers many ways of doing things, another command that shows your current active connection is</p>
<pre class="highlight shell"><code>nmcli connection show --active
</code></pre>
<p>which outputs like so:</p>
<pre class="highlight shell"><code>NAME  UUID                                  TYPE             DEVICE
NTC   59962bac-3441-437b-94ea-bf31dee66e8f  802-11-wireless  wlan0
</code></pre>
<p>After you have connected once, your C.H.I.P. will automatically connect to this network next time you reboot (or start NetworkManager services).</p>

<h5 id="test">Test</h5>

<p>Finally, you can test your connection to the internet with <code class="prettyprint">ping</code>. Google&rsquo;s DNS server at the IP address 8.8.8.8 is probably the most reliable computer on the internet, so:</p>
<pre class="highlight shell"><code>ping -c 4 8.8.8.8
</code></pre>
<p>results in output like:</p>
<pre class="highlight shell"><code>64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>297 ms
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>26.3 ms
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>3 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>24.8 ms
64 bytes from 8.8.8.8: <span class="nv">icmp_seq</span><span class="o">=</span>4 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>55.7 ms
</code></pre>
<p>You can stop this command by pressing CTRL-C on your keyboard. The <code class="prettyprint">-c 4</code> option means it will happen only 4 times.</p>

<p>Congratulations! You are now network with CHIP!</p>

<h4 id="step-4-disconnecting-and-forgetting-networks">Step 4: Disconnecting and Forgetting Networks</h4>

<p>The command to disconnect from a wireless device needs a few parameters:</p>
<pre class="highlight shell"><code>sudo nmcli dev disconnect wlan0
</code></pre>
<p>You may want to prevent auto-connection to a network, so you can use this process to &ldquo;forget&rdquo; a network. First, get the connection names:</p>
<pre class="highlight shell"><code>nmcli c
</code></pre>
<p>which outputs something like</p>
<pre class="highlight shell"><code>NAME       UUID                                  TYPE             DEVICE 
NTC 2461   d0a6fb32-3ed8-4a95-a631-ee2ae6153761  802-11-wireless  wlan0
</code></pre>
<p>then, disconnect (using the example above)</p>
<pre class="highlight shell"><code>sudo nmcli connection delete id <span class="s2">"NTC 2461"</span>
</code></pre>
<h4 id="troubleshooting-networks">Troubleshooting Networks</h4>

<p>Here are a few possible problems with connections.</p>

<h5 id="no-network-found">No network found</h5>

<p>Not much to say about that. If there&rsquo;s no network, you can&rsquo;t connect. Go find a network!</p>

<h5 id="incorrect-password">Incorrect password</h5>

<p>If you type in the wrong password, you&rsquo;ll get some errors like this:</p>
<pre class="highlight shell"><code><span class="o">[</span>32258.690000] RTL871X: rtw_set_802_11_connect<span class="o">(</span>wlan0<span class="o">)</span> <span class="nv">fw_state</span><span class="o">=</span>0x00000008
<span class="o">[</span>32258.800000] RTL871X: start auth
<span class="o">[</span>32263.720000] RTL871X: rtw_set_802_11_connect<span class="o">(</span>wlan0<span class="o">)</span> <span class="nv">fw_state</span><span class="o">=</span>0x00000008
<span class="o">[</span>32263.820000] RTL871X: start auth
<span class="o">[</span>32264.430000] RTL871X: auth success, start assoc
<span class="o">[</span>32269.850000] RTL871X: rtw_set_802_11_connect<span class="o">(</span>wlan0<span class="o">)</span> <span class="nv">fw_state</span><span class="o">=</span>0x00000008
<span class="o">[</span>32269.970000] RTL871X: start auth
Error: Timeout 90 sec expired.
</code></pre>
<p>Try connecting again with the correct password.</p>

<h5 id="failed-ping">Failed ping</h5>

<p>If you don&rsquo;t have access to the internet, your ping to an outside IP will fail.
It is possible that you can connect to a wireless network, but have no access to the internet, so you&rsquo;d see a connection when you request device status, but have a failed ping. This indicates a problem or restriction with the router or the access point, not a problem with the CHIP.</p>

<p>A failed ping looks something like:</p>
<pre class="highlight shell"><code>From 192.168.2.56 <span class="nv">icmp_seq</span><span class="o">=</span>14 Destination Host Unreachable
From 192.168.2.56 <span class="nv">icmp_seq</span><span class="o">=</span>15 Destination Host Unreachable
From 192.168.2.56 <span class="nv">icmp_seq</span><span class="o">=</span>16 Destination Host Unreachable
18 packets transmitted, 0 received, +9 errors, 100% packet loss, <span class="nb">time </span>17013ms
pipe 4
</code></pre>
<h5 id="loss-of-wireless-network">Loss of wireless network</h5>

<p>A sudden, unplanned disconnection will post an error in the terminal window, for example:</p>
<pre class="highlight shell"><code><span class="o">[</span>30863.880000] RTL871X: linked_status_chk<span class="o">(</span>wlan0<span class="o">)</span> disconnect or roaming
</code></pre>
<p>The Network Manager will periodically try to reconnect. If the access point is restored, you&rsquo;ll get something like this in your terminal window:</p>
<pre class="highlight shell"><code><span class="o">[</span>31798.970000] RTL871X: rtw_set_802_11_connect<span class="o">(</span>wlan0<span class="o">)</span>
<span class="o">[</span>31799.030000] RTL871X: start auth
<span class="o">[</span>31799.040000] RTL871X: auth success, start assoc
<span class="o">[</span>31799.050000] RTL871X: rtw_cfg80211_indicate_connect<span class="o">(</span>wlan0<span class="o">)</span> BSS not found !!
<span class="o">[</span>31799.060000] RTL871X: assoc success
</code></pre>
<h5 id="nmcli-not-installed-error">nmcli not installed error</h5>

<p>If you try to use <code class="prettyprint">nmcli</code> and you get an error that it is not found or is not a command, chances are that you are using the CHIP buildroot image. The <code class="prettyprint">nmcli</code> commands only apply to CHIPs running CHIP OS or Debian linux.</p>

<h3 id="connecting-c-h-i-p-to-a-wireless-network-with-connman">Connecting C.H.I.P. to a Wireless Network With connman</h3>

<p>The buildroot operating system uses the <code class="prettyprint">connman</code> command-line network manager to connect and manage your network connections. If you are using CHIP OS (or Debian), you will find that <code class="prettyprint">connman</code> is not installed - you&rsquo;ll need to <a href="#connecting-c-h-i-p-to-wi-fi-with-nmcli">use  nmcli</a>.</p>

<p>If you want all the details of <code class="prettyprint">connman</code> <a href="https://wiki.archlinux.org/index.php/Connman">visit the ArchLinux wiki.</a></p>

<h4 id="requirements">Requirements</h4>

<ul>
<li>CHIP running buildroot OS</li>
<li>One of the following:

<ul>
<li>Keyboard and monitor for CHIP</li>
<li><a href="#headless-chip">Serial connection</a> to CHIP</li>
</ul></li>
</ul>

<h4 id="step-1-enable-wifi-and-find-a-network">Step 1: Enable WiFi and Find a Network</h4>

<p>These three commands will, in turn, enable wifi, scan for access points, and see what networks are available:</p>
<pre class="highlight shell"><code>  connmanctl <span class="nb">enable </span>wifi
  connmanctl scan wifi
  connmanctl services
</code></pre>
<p>The <code class="prettyprint">services</code> command has output similar to:</p>
<pre class="highlight shell"><code><span class="k">*</span>AO
    NTC                  wifi_7cc70905cd77_4e5443_managed_psk
                         wifi_7cc70905cd77_hidden_managed_psk
    NTC Guest            wifi_7cc70905cd77_4e5443204775657374_managed_psk
                         wifi_7cc70905cd77_hidden_managed_none
    ATT312               wifi_7cc70905cd77_415454333132_managed_psk
    HP-Print-99-LaserJet 1102 wifi_7cc70905cd77_48502d5072696e742d39392d4c617365724a65742031313032_managed_none
    ATT344               wifi_7cc70905cd77_415454333434_managed_psk
    CBCI-1B57-2.4        wifi_7cc70905cd77_434243492d314235372d322e34_managed_psk
    mi-fi                wifi_7cc70905cd77_6d692d6669_managed_none
    0024A5D8CF33         wifi_7cc70905cd77_303032344135443843463333_managed_psk
    Twirl-Eco-Events-2.4 wifi_7cc70905cd77_547769726c2d45636f2d4576656e74732d322e34_managed_psk
    xfinitywifi          wifi_7cc70905cd77_7866696e69747977696669_managed_none
</code></pre>
<h4 id="step-2-connect-to-an-access-point">Step 2: Connect To An Access Point</h4>

<p>Unfortunately, connman doesn&rsquo;t use the nice name on the left of the services list. It wants the unfriendly string on the right, so you&rsquo;ll want to get copy and paste ready.</p>

<h5 id="a-no-password">A: No Password</h5>

<p>For example, to connect to NTC Guest, which has no password, <code class="prettyprint">services</code> shows two choices. We want the one without “hidden” in the string. Use the connect command to connect:</p>
<pre class="highlight shell"><code>  connmanctl connect wifi_7cc70905cd77_4e5443204775657374_managed_psk
</code></pre>
<p>If your network is not password protected, you&rsquo;ll get some output that will indicate a successful connection, such as:</p>
<pre class="highlight shell"><code><span class="o">[</span>  961.780000] RTL871X: rtw_set_802_11_connect<span class="o">(</span>wlan0<span class="o">)</span>  <span class="nv">fw_state</span><span class="o">=</span>0x00000008
<span class="o">[</span>  962.070000] RTL871X: start auth
<span class="o">[</span>  962.080000] RTL871X: auth success, start assoc
<span class="o">[</span>  962.090000] RTL871X: rtw_cfg80211_indicate_connect<span class="o">(</span>wlan0<span class="o">)</span> BSS not found !!
<span class="o">[</span>  962.100000] RTL871X: assoc success
<span class="o">[</span>  962.110000] RTL871X: send eapol packet
<span class="o">[</span>  962.290000] RTL871X: send eapol packet
<span class="o">[</span>  962.300000] RTL871X: <span class="nb">set </span>pairwise key camid:4, addr:0a:18:d6:97:2d:26, kid:0, <span class="nb">type</span>:AES
<span class="o">[</span>  962.320000] RTL871X: <span class="nb">set </span>group key camid:5, addr:0a:18:d6:97:2d:26, kid:1, <span class="nb">type</span>:AES
</code></pre>
<p>If your network is password protected, you&rsquo;ll get an error.</p>

<h5 id="b-password-protected">B: Password-Protected</h5>

<p>To deal with passwords, you&rsquo;ll need to put <code class="prettyprint">connman</code> into interactive mode:</p>
<pre class="highlight shell"><code>  connmanctl
</code></pre>
<p>which gives a connmanctl prompt:</p>
<pre class="highlight shell"><code>  connmanctl&gt;
</code></pre>
<p>In the shell, turn the &#39;agent&rsquo; on so it can process password requests:</p>
<pre class="highlight shell"><code>  agent on
</code></pre>
<p>and now use the connect command (your network name will be different than what&rsquo;s below of course)</p>
<pre class="highlight shell"><code>  connect wifi_7cc70905cd77_4e5443_managed_psk
</code></pre>
<p>and enter your password when prompted:</p>
<pre class="highlight shell"><code>  Agent RequestInput wifi_7cc70905cd77_4e5443_managed_psk
  Passphrase <span class="o">=</span> <span class="o">[</span> <span class="nv">Type</span><span class="o">=</span>psk, <span class="nv">Requirement</span><span class="o">=</span>mandatory <span class="o">]</span>
  Passphrase?
</code></pre>
<p>Now that you are connected to a wireless network, you can exit connmanctl interactive mode by typing</p>
<pre class="highlight shell"><code>  quit
</code></pre>
<h6 id="all-the-commands-in-one-place">All The Commands In One Place</h6>

<p>Here&rsquo;s all the commands in one place:</p>
<pre class="highlight shell"><code>  connmanctl
  agent on
  connect wifi_7cc70905cd77_4e5443_managed_psk
  quit
</code></pre>
<h4 id="step-3-test-connection">Step 3: Test Connection</h4>

<p>In CHIP&rsquo;s command line, you can ping Google four times:</p>
<pre class="highlight shell"><code>  ping -c 4 8.8.8.8
</code></pre>
<p>and expect ping to output some timing messages like:</p>
<pre class="highlight shell"><code>PING 8.8.8.8 <span class="o">(</span>8.8.8.8<span class="o">)</span>: 56 data bytes
64 bytes from 8.8.8.8: <span class="nv">seq</span><span class="o">=</span>0 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>209.147 ms
64 bytes from 8.8.8.8: <span class="nv">seq</span><span class="o">=</span>1 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>111.125 ms
64 bytes from 8.8.8.8: <span class="nv">seq</span><span class="o">=</span>2 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>183.627 ms
64 bytes from 8.8.8.8: <span class="nv">seq</span><span class="o">=</span>3 <span class="nv">ttl</span><span class="o">=</span>55 <span class="nb">time</span><span class="o">=</span>147.398 ms
--- 8.8.8.8 ping statistics ---
4 packets transmitted, 4 packets received, 0% packet loss
round-trip min/avg/max <span class="o">=</span> 111.125/162.824/209.147 ms
</code></pre>
<p>If your connection is not successful, then ping will tell you your network is down:</p>
<pre class="highlight shell"><code>PING 8.8.8.8 <span class="o">(</span>8.8.8.8<span class="o">)</span>: 56 data bytes
ping: sendto: Network is unreachable
</code></pre>
<h5 id="troubleshooting-connection-problems">Troubleshooting Connection Problems</h5>

<ul>
<li>You&rsquo;ll need to make sure you used the right network when you used the connect commnand.</li>
<li>Review any messages that the connect commnand gave you. Did they look like the examples of a successful connection?</li>
<li>If everything checked out until you got to <code class="prettyprint">ping</code>, there&rsquo;s a good chance the problem is with your router or connection to the internet.</li>
</ul>

<h5 id="connman-not-installed-error">connman not installed error</h5>

<p>If you try to use <code class="prettyprint">connman</code> and you get an error that it is not found or is not a command, chances are that you are using the CHIP OS or Debian image. The <code class="prettyprint">connman</code> commands only apply to CHIPs running the simple buildroot OS.</p>

<h4 id="step-4-disconnecting-and-forgetting-networks">Step 4: Disconnecting And Forgetting Networks</h4>

<p>To disconnect from your network, you might first want a reminder of what unfriendly string is used to describe your access point, so type:</p>
<pre class="highlight shell"><code>  connmanctl services
</code></pre>
<p>which will output information about your current link:</p>
<pre class="highlight shell"><code>  <span class="k">*</span>AO NTC                  wifi_7cc70905cd77_4e5443_managed_psk
</code></pre>
<p>Use the ID to disconnect:</p>
<pre class="highlight shell"><code>  connmanctl disconnect wifi_7cc70905cd77_4e5443_managed_psk
</code></pre>
<p>and you&rsquo;ll get some status like this:</p>
<pre class="highlight shell"><code><span class="o">[</span>  301.890000] RTL871X: clear key <span class="k">for </span>addr:0a:18:d6:97:2d:26, camid:4
<span class="o">[</span>  301.900000] RTL871X: clear key <span class="k">for </span>addr:0a:18:d6:97:2d:26, camid:5
<span class="o">[</span>  301.920000] IPv6: ADDRCONF<span class="o">(</span>NETDEV_UP<span class="o">)</span>: wlan0: link is not ready
Disconnected wifi_7cc70905cd77_4e5443_managed_psk
</code></pre>
<p>Generally, <code class="prettyprint">conman</code> will remember and cache setup information - if you reboot in the vicinity of a known network, it will attempt to connect. However, if you need to forget a network setup, these setups can be found by navigating:</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> /var/lib/connman/
</code></pre>
<p>You can delete a single connection by seeing what connections are stored</p>
<pre class="highlight shell"><code>  ls /var/lib/connman/
</code></pre>
<p>and then delete a setup that you find, for example</p>
<pre class="highlight shell"><code>  rm -r wifi_7cc70905cd77_4e5443_managed_psk
</code></pre>
<p>You can delete all the “wifi” directories with</p>
<pre class="highlight shell"><code>  rm -r wifi<span class="k">*</span>
</code></pre>
<p>(the <code class="prettyprint">-r</code> is needed because these are directories you are deleting, and the star at the end of <code class="prettyprint">wifi*</code> assumes your configurations all start with the string “wifi”)</p>

<h4 id="for-advanced-users">For Advanced Users</h4>

<p>It&rsquo;s worth noting that you&rsquo;ll see two wireless networking interfaces if you list them with</p>
<pre class="highlight shell"><code>  ifconfig
</code></pre>
<p><code class="prettyprint">connman</code> is configured to see only the physical interface wlan0 which simplifies setup. We do this with a blacklist, which can be modified at <code class="prettyprint">/etc/connman/main.conf</code></p>

<h2 id="configure-sound-output-on-debian">Configure Sound Output on Debian</h2>

<p>Getting simple audio playback working on CHIP is pretty easy, once you install the correct packages and enable audio output. In the code examples below, we&rsquo;ve inserted the &amp;&amp; characters at the end of lines so you can copy and paste the entire block into a terminal window and execute each line in series.
If you are using CHIP OS, sound output is already configured and working. However, you may be running a simple version of Debian or buildroot, so these instructions will help you get sound working on CHIP.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>CHIP</li>
<li><a href="#headless-chip">SSH or serial connection to CHIP</a> or</li>
<li>Monitor and keyboard</li>
<li>Headphones or powered speakers connected to CHIP a/v jack</li>
<li><a href="#connecting-c-h-i-p-to-wi-fi-with-nmcli">Connection to a network</a></li>
</ul>

<h3 id="setup-chip">Setup CHIP</h3>

<p>Update your apt repository list if you haven&rsquo;t done so recently:</p>
<pre class="highlight shell"><code>  sudo apt-get update
</code></pre>
<p>Then install ALSA:</p>
<pre class="highlight shell"><code>  sudo apt-get install libasound2 alsa-utils
</code></pre>
<p>This will install alsa and some utilities for playing sound from the command line. Once those have installed, you&rsquo;ll need to make the outputs active for sound</p>
<pre class="highlight shell"><code>  alsamixer
</code></pre>
<p>will open up a simple interface. Use the left and right arrow keys on your keyboard to select among the items, and use the up/down keys to change the options:</p>

<ul>
<li>DAC Output - set to Direct</li>
<li>Left Mixer - set to Left</li>
<li>PA - set to desired volume</li>
<li>Right Mixer - set to Right</li>
</ul>

<p><img src="images/alsamixer.jpg" alt="alsamixer interface" /></p>

<h3 id="play-a-sound">Play a Sound</h3>

<p>Change to the root media directory:</p>
<pre class="highlight shell"><code>  <span class="nb">cd</span> /media
</code></pre>
<p>Alternatively, you could download a sound into chip&rsquo;s home directory:</p>
<pre class="highlight shell"><code>  mkdir /home/chip/Media <span class="o">&amp;&amp;</span> <span class="nb">cd</span> /home/chip/Media
</code></pre>
<p>Use <code class="prettyprint">wget</code> to download a sound of piano chords to the file test.wav:</p>
<pre class="highlight shell"><code>  wget -O test.wav https://upload.wikimedia.org/wikipedia/commons/d/db/Descending_thirds.wav
</code></pre>
<p>If wget returns command not found you can install it:</p>
<pre class="highlight shell"><code>  sudo apt-get install wget
</code></pre>
<p>We can finally play the sound and hear it over CHIP&rsquo;s headphone jack:</p>
<pre class="highlight shell"><code>  aplay test.wav
</code></pre>
<p>If you want to play mp3 or ogg files, you can install mplayer:</p>
<pre class="highlight shell"><code>  sudo apt-get install mplayer
</code></pre>
<p>Then try an ogg file:</p>
<pre class="highlight shell"><code>  wget -O test.ogg https://upload.wikimedia.org/wikipedia/commons/e/e7/Agogo.ogg <span class="o">&amp;&amp;</span>
  mplayer test.ogg
</code></pre>
<p>And mp3 file:</p>
<pre class="highlight shell"><code>  wget -O test.mp3 http://www.freesound.org/data/previews/315/315618_2050105-lq.mp3 <span class="o">&amp;&amp;</span>
  mplayer test.mp3
</code></pre>
<h3 id="record-a-sound">Record A Sound</h3>

<p>If you want to try the audio input, you need to connect audio input to <a href="#pin-headers">header U14, pins 06 &amp; 12</a> or <a href="#microphone-and-audio-input">modify CHIP</a> to use audio in on the TRRS connector.
Once you have an audio signal going into CHIP, you can test it out by recording a three second (<code class="prettyprint">-d 3</code>) WAV file with arecord:</p>
<pre class="highlight shell"><code>arecord -f <span class="nb">cd</span> -d 3 -D hw:0,0 chipaudioin.wav
</code></pre>
<h3 id="more-packages">More Packages</h3>

<p>Developers that want to use sound will probably want to download these packages:</p>
<pre class="highlight shell"><code>sudo apt-get install portaudio19-dev <span class="o">&amp;&amp;</span>
sudo apt-get install swig <span class="o">&amp;&amp;</span>
sudo apt-get install python-setup-tools <span class="o">&amp;&amp;</span>
sudo apt-get install python-dev
</code></pre>
<h2 id="usb-storage-devices">USB Storage Devices</h2>

<p>In this tutorial, we&rsquo;ll describe how you can use the USB port to add more storage with a thumb drive, hard drive, card reader, or whatever else. You can then copy, store, and edit files on the storage device, extending the capability of CHIP.</p>

<p>This tutorial is suitable for the buildroot image. If you are following this for other Linux distributions, there are some adjustments that you&rsquo;ll need to make for paths, permissions, and enabling &#39;sudo.&rsquo; With buildroot, you work as the root user, so this tutorial is appropriately terse.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>USB thumb drive or hard drive</li>
<li>Computer running OS X 10.10+, Ubuntu 14.04+, or Windows 7+ (to format USB device, if needed)</li>
</ul>

<h3 id="step-1-format-the-drive">Step 1: Format the Drive</h3>

<p>First, you&rsquo;ll want to format the drive as an MS-DOS (FAT), NTFS, or ext3 volume. You can do this on another computer.</p>

<p>Once formatted, insert the drive into CHIP&rsquo;s USB port. Enter the command</p>
<pre class="highlight shell"><code>dmesg
</code></pre>
<p>You&rsquo;ll get output like:</p>
<pre class="highlight shell"><code><span class="o">[</span> 4953.430000] usb 1-1: new high-speed USB device number 2 using ehci-platform
<span class="o">[</span> 4953.580000] usb-storage 1-1:1.0: USB Mass Storage device detected
<span class="o">[</span> 4953.590000] scsi host0: usb-storage 1-1:1.0
<span class="o">[</span> 4954.590000] scsi 0:0:0:0: Direct-Access USB Flash Memory 1.00 PQ: 0 ANSI: 2
<span class="o">[</span> 4954.600000] sd 0:0:0:0: <span class="o">[</span>sda] 3911616 512-byte logical blocks: <span class="o">(</span>2.00 GB/1.86 GiB<span class="o">)</span>
<span class="o">[</span> 4954.610000] sd 0:0:0:0: <span class="o">[</span>sda] Write Protect is off
<span class="o">[</span> 4954.620000] sd 0:0:0:0: <span class="o">[</span>sda] Mode Sense: 65 44 09 30
<span class="o">[</span> 4954.630000] sd 0:0:0:0: <span class="o">[</span>sda] No Caching mode page found
<span class="o">[</span> 4954.630000] sd 0:0:0:0: <span class="o">[</span>sda] Assuming drive cache: write through
<span class="o">[</span> 4954.650000] sda: sda1
<span class="o">[</span> 4954.650000] sd 0:0:0:0: <span class="o">[</span>sda] Attached SCSI removable disk
</code></pre>
<p>Notice the second to last line. This tells you the device location for the drive. Storage devices generally have device names that start with “sd”. If you want to see all the storage devices attached to CHIP, you can use a wildcard to display all devices that start with “sd”:</p>
<pre class="highlight shell"><code>ls /dev/sd<span class="k">*</span>
</code></pre>
<p>and you&rsquo;ll get something like:</p>
<pre class="highlight shell"><code>/dev/sda /dev/sda1
</code></pre>
<p>With one thumb drive attached, it appears as two devices: the device itself (sda), and the storage partitions (sda1). There is only one partition on this drive.</p>

<p>Another way to find storage devices is the command</p>
<pre class="highlight shell"><code>blkid
</code></pre>
<p>which lists them, along with the names you might have initialized them with:</p>
<pre class="highlight shell"><code>/dev/sda1: <span class="nv">LABEL</span><span class="o">=</span><span class="s2">"TEST"</span> <span class="nv">UUID</span><span class="o">=</span><span class="s2">"6668-11E9"</span>
</code></pre>
<h3 id="step-2-mount-the-drive-device-to-your-filesystem">Step 2: Mount the Drive Device to Your Filesystem</h3>

<p>Now that you know where your partition is, it&rsquo;s time to mount the partition so you can access the files.</p>

<p>First, make a directory where your drive can mount:</p>
<pre class="highlight shell"><code>sudo mkdir /drives
</code></pre>
<p>Mount the drive device to your /drives directory:</p>
<pre class="highlight shell"><code>sudo mount /dev/sda1 /drives
</code></pre>
<p>Now you can navigate to the <code class="prettyprint">drives</code> directory and see all the files in the drive:</p>
<pre class="highlight shell"><code><span class="nb">cd</span> /drives
ls
</code></pre>
<h3 id="step-3-unmount-the-drive-from-filesystem">Step 3: Unmount the Drive From Filesystem</h3>

<p>If you want to remove the drive from the USB port on CHIP, it&rsquo;s best to unmount it:</p>
<pre class="highlight shell"><code>sudo umount /dev/sda1
</code></pre>
<h3 id="step-4-automatic-mounting-on-boot">Step 4: Automatic Mounting on Boot</h3>

<p>You&rsquo;ll probably want to mount this drive automatically next time you use it, though. We can set that up with a quick modification to the <code class="prettyprint">fstab</code> (file system table) document:</p>
<pre class="highlight shell"><code>vi /etc/fstab
</code></pre>
<p>Getting around vi is not very intuitive. If you are new to it, here&rsquo;s a quick guide on getting this text into the fstab document:</p>

<ul>
<li>&#39;arrow&rsquo; key to the end of the file,</li>
<li>press the &#39;i&rsquo; key to insert text</li>
<li>type (or copy-paste) this:</li>
</ul>
<pre class="highlight shell"><code>/dev/sda1 /drives vfat defaults 0 0
</code></pre>
<p>To exit vi,</p>

<ul>
<li>press the &#39;esc&rsquo; key,</li>
<li>type &rsquo;:&rsquo; (colon),</li>
<li>type &#39;wq&rsquo; to write and quit vi.</li>
</ul>

<p>You can test your work with:</p>
<pre class="highlight shell"><code>mount -a
</code></pre>
<p>If there&rsquo;s an error, double check the <code class="prettyprint">fstab</code> file and make sure it has the line <code class="prettyprint">/dev/sda1 /drives vfat defaults 0 0</code> at the end. If it&rsquo;s successful, you&rsquo;ll be able to view, modify and copy the files on the disk:</p>
<pre class="highlight shell"><code>ls /drives
</code></pre>
<p>Now, if you reboot , the drive will mount automatically. If you remove the drive, then insert it again, you&rsquo;ll need the command</p>
<pre class="highlight shell"><code>mount -a
</code></pre>
<h2 id="connecting-bluetooth-devices">Connecting Bluetooth Devices</h2>

<p>CHIP has built-in Bluetooth and uses the <a href="http://www.bluez.org/">bluez 5 stack</a> for implementing connections and devices. 
This tutorial instructs how to use a Bluetooth keyboard, since it is a simple and obvious example. 
There are, of course, several types of Bluetooth devices, such as earpieces, audio connectors, vacuum cleaners, and more. 
Future tutorials (search our <a href="http://bbs.nextthing.co">bbs</a> will cover those devices, but the keyboard is a good introduction to the commands and an easy way to test your system.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>CHIP</li>
<li>SSH or serial connection to CHIP or</li>
<li>Monitor and keyboard</li>
<li>Bluetooth device, preferably keyboard</li>
</ul>

<h3 id="important">Important!</h3>

<p>Start with a CHIP completely unplugged and powered down. Add power and boot up. A known limitation is that after <code class="prettyprint">reboot</code>, CHIP&rsquo;s Bluetooth controller may not work until you <code class="prettyprint">power</code> and physically disconnect from a power source.</p>

<h3 id="about-bluetoothctl">About <code class="prettyprint">bluetoothctl</code></h3>

<p>We&rsquo;ll be using the command <code class="prettyprint">bluetoothctl</code> to find, pair with, and connect to devices. </p>

<p>In the terminal, type</p>
<pre class="highlight shell"><code>  bluetoothctl
</code></pre>
<p>This starts up <code class="prettyprint">bluetoothctl</code> in interactive mode. You should see output like</p>
<pre class="highlight shell"><code><span class="o">[</span>NEW] Controller 7C:C7:08:05:CD:77 BlueZ 5.27 <span class="o">[</span>default]
<span class="o">[</span>NEW] Device 60:33:4B:13:A7:45 nyb
<span class="o">[</span>NEW] Device 15:03:26:A0:26:26 SK032B02-2626
</code></pre>
<p>which is a list of MAC addresses of CHIP&rsquo;s Bluetooth controller chip (the first line) and any other devices that have been paired with CHIP in the past. 
Use the <code class="prettyprint">help</code> command - it lists all the very useful commands in the <code class="prettyprint">bluetoothctl</code> interactive mode.</p>

<p>In Bluetooth interactive mode, use the command</p>
<pre class="highlight shell"><code>  power on
</code></pre>
<p>which outputs</p>
<pre class="highlight shell"><code>Changing power on succeeded
<span class="o">[</span>CHG] Controller 7C:C7:08:05:CD:77 Powered: yes
</code></pre>
<h3 id="find-a-bluetooth-device">Find A Bluetooth Device</h3>

<p>If you need to discover a device, start the scan process:</p>
<pre class="highlight shell"><code>  scan on
</code></pre>
<p>which will start printing MAC addresses and names (if available) of Bluetooth devices in your vicinity.</p>
<pre class="highlight shell"><code><span class="o">[</span>NEW] Device 15:03:26:A0:26:26 SK032B02-2626
<span class="o">[</span>NEW] Device 1C:1A:C0:85:5E:2C 1C-1A-C0-85-5E-2C
<span class="o">[</span>NEW] Device 60:33:4B:13:A7:45 nyb
</code></pre>
<h3 id="pair-with-a-bluetooth-device">Pair With A Bluetooth Device</h3>

<p>Pair to a device with the MAC address and the <code class="prettyprint">pair</code> command:</p>
<pre class="highlight shell"><code>  pair 1C:1A:C0:85:5E:2C
</code></pre>
<p>This may fail if the device is powered off, goes out of range, or your toddler spills water on it. Here&rsquo;s what failure looks like:</p>
<pre class="highlight shell"><code>Attempting to pair with 1C:1A:C0:85:5E:2C
<span class="o">[</span>CHG] Device 1C:1A:C0:85:5E:2C Connected: yes
<span class="o">[</span>CHG] Device 1C:1A:C0:85:5E:2C Connected: no
Failed to pair: org.bluez.Error.AuthenticationCanceled
</code></pre>
<p>As the scan continues, you&rsquo;ll eventually see the device you are interested in, so copy that MAC address and type:</p>
<pre class="highlight shell"><code>  pair 15:03:26:A0:26:26
</code></pre>
<p>with output like:</p>
<pre class="highlight shell"><code><span class="o">[</span>CHG] Device 15:03:26:A0:26:26 Connected: yes
<span class="o">[</span>CHG] Device 15:03:26:A0:26:26 Modalias: usb:v05ACp3232d0001
<span class="o">[</span>CHG] Device 15:03:26:A0:26:26 UUIDs:
 00001124-0000-1000-8000-00805f9b34fb
 00001200-0000-1000-8000-00805f9b34fb
<span class="o">[</span>CHG] Device 15:03:26:A0:26:26 Paired: yes
Pairing successful
<span class="o">[</span>CHG] Device 15:03:26:A0:26:26 Connected: no
Pair with a Bluetooth Device with Password <span class="o">(</span>keyboard<span class="o">)</span>
</code></pre>
<p>Some Bluetooth devices need user input to pair. In that case, you&rsquo;ll need to turn the agent &#39;on&rsquo; so the device can post a password, and you can enter it:</p>
<pre class="highlight shell"><code>  agent on
</code></pre>
<p>will output</p>
<pre class="highlight shell"><code>  Agent registered
</code></pre>
<p>now you can pair it:</p>
<pre class="highlight shell"><code>  pair DC:2C:26:D7:B6:8F
</code></pre>
<p>will output</p>
<pre class="highlight shell"><code>Attempting to pair with DC:2C:26:D7:B6:8F
<span class="o">[</span>CHG] Device DC:2C:26:D7:B6:8F Connected: yes
<span class="o">[</span>agent] PIN code: 245261
</code></pre>
<p>Now you can use the Bluetooth device to enter the PIN code, then hit enter. The terminal will give some status about the pairing:</p>
<pre class="highlight shell"><code><span class="o">[</span>CHG] Device DC:2C:26:D7:B6:8F Modalias: usb:v05ACp022Cd011B
<span class="o">[</span>CHG] Device DC:2C:26:D7:B6:8F UUIDs:
        00001000-0000-1000-8000-00805f9b34fb
        00001124-0000-1000-8000-00805f9b34fb
        00001200-0000-1000-8000-00805f9b34fb
<span class="o">[</span>CHG] Device DC:2C:26:D7:B6:8F Paired: yes
Pairing successful
<span class="o">[</span>CHG] Device DC:2C:26:D7:B6:8F Connected: no
</code></pre>
<p>Now that you are paired, you will have to connect.</p>

<h3 id="connect-with-a-bluetooth-device">Connect With A Bluetooth Device</h3>

<p>Now that you have paired the Bluetooth device, you won&rsquo;t have to do that again. However, the device still needs to be connected:</p>
<pre class="highlight shell"><code>  connect 15:03:26:A0:26:26
</code></pre>
<p>will output, when successful:</p>
<pre class="highlight shell"><code>Attempting to connect to 15:03:26:A0:26:26
<span class="o">[</span>CHG] Device 15:03:26:A0:26:26 Connected: yes
Connection successful
<span class="gp">[bluetooth]## </span><span class="o">[</span> 1405.340000] hid-generic 0005:05AC:3232.0001: unknown main item tag 0x0
<span class="o">[</span> 1405.360000] input: SK032B02-2626 as /devices/platform/soc@01c00000/1c28c00.serial/tty/ttyS1/hci0/hci0:4/0005:05AC:3232.0001/input/input1
<span class="o">[</span> 1405.380000] hid-generic 0005:05AC:3232.0001: input: BLUETOOTH HID v0.01 Mouse <span class="o">[</span>SK032B02-2626] on 7c:c7:08:05:cd:77
</code></pre>
<p>or, if the device is not available, it will fail:</p>
<pre class="highlight shell"><code>Attempting to connect to 15:03:26:A0:26:26
<span class="gp">[bluetooth]## </span><span class="o">[</span> 1304.470000] Bluetooth: HIDP <span class="o">(</span>Human Interface Emulation<span class="o">)</span> ver 1.2
<span class="o">[</span> 1304.480000] Bluetooth: HIDP socket layer initialized
Failed to connect: org.bluez.Error.Failed
</code></pre>
<h3 id="trusting-a-bluetooth-device">Trusting a Bluetooth Device</h3>

<p>Trust between people leads to understanding and perhaps even harmonious living. Trust between bluetooth devices means that you won&rsquo;t have to connect the device every time it&rsquo;s near. Which is a sort of harmony, I suppose. 
Once you have connected a bluetooth device to CHIP, if you intend to use it again, you can trust it:</p>
<pre class="highlight shell"><code> trust 15:03:26:A0:26:26
</code></pre>
<h3 id="remove-a-bluetooth-device">Remove a Bluetooth device</h3>

<p>You may want CHIP to not pair or connect to a device - perhaps the conveniently trusted device needs to be freed for another connection. Whatever the reason, if you want to remove your Bluetooth device, </p>
<pre class="highlight shell"><code> remove 15:03:26:A0:26:26
</code></pre>
<h3 id="troubleshooting-bluetooth">Troubleshooting Bluetooth</h3>

<p>If your Bluetooth controller module on CHIP is not functioning, you can easily find the problem. Type</p>
<pre class="highlight shell"><code>  bluetoothctl
</code></pre>
<p>to get into the interactive mode, then type</p>
<pre class="highlight shell"><code>  power on
</code></pre>
<p>If you get the response</p>
<pre class="highlight shell"><code>  No default controller available
</code></pre>
<p>Then there&rsquo;s a problem with CHIP recognizing the Bluetooth module. <a href="#important!">Read the very first instructions</a> at the top of this tutorial.</p>

<h2 id="install-x-windows">Install X-windows</h2>

<p>If you want a windowed desktop on C.H.I.P., you can install X-Windows.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>CHIP <a href="#connecting-c-h-i-p-to-wi-fi-with-nmcli">connected to WiFi</a></li>
<li>Monitor attached to CHIP</li>
<li>Keyboard or <a href="#headless-chip">Serial or SSH Connection</a> to CHIP</li>
</ul>

<h3 id="installation-xfce4">Installation (xfce4)</h3>

<p>CHIP is a lightweight computer, so we&rsquo;ll install the lightweight xfce4:</p>
<pre class="highlight shell"><code>  sudo apt-get install xfce4
</code></pre>
<p>It might take some time to download and install all the packages, since there are a lot of dependencies and libraries involved. Once installed, start the windowing system with the command</p>
<pre class="highlight shell"><code>  startx&amp;
</code></pre>
<p>(the <code class="prettyprint">&amp;</code> runs Xwindows in the background, so you can still use your terminal). After a minute or so, you&rsquo;ll get an image on the monitor:</p>

<p><img src="images/xwindows_first.jpg" alt="Xwindows up and running on CHIP" /></p>

<p>Now you can use a mouse and keyboard to explore CHIP and launch programs.</p>

<h3 id="troubleshooting-apt-get">Troubleshooting apt-get</h3>

<p>If you get errors from apt that report &ldquo;unmet dependencies,&rdquo; you can run the command</p>
<pre class="highlight shell"><code>sudo apt-get install -f
</code></pre>
<p>which will force installation of any alternate or missing dependencies of any installed packages.</p>

          <h2 id="install-the-latest-puredata">Install the latest PureData</h2>

<p>The latest versions of PureData can be installed via apt-get. Use these commands (or put them in a script). This adds a repository source to your apt sources, updates apt-get, then installs puredata and all the dependencies.</p>
<pre class="highlight shell"><code><span class="c">#!/bin/bash</span>
<span class="nb">echo</span> <span class="s2">"deb http://ftp.de.debian.org/debian stretch main"</span> | sudo tee --append /etc/apt/sources.list
sudo apt-get update
sudo apt-get install -y puredata
<span class="nb">echo</span> <span class="s2">"@audio - rtprio 99"</span> | sudo tee --append /etc/security/limits.conf
<span class="nb">echo</span> <span class="s2">"@audio - memlock unlimited"</span> | sudo tee --append /etc/security/limits.conf
<span class="nv">WHO</span><span class="o">=</span><span class="nv">$USER</span>
sudo adduser <span class="nv">$WHO</span> audio
</code></pre>
<h2 id="building-and-installing-puredata-pd-on-chip">Building and Installing PureData (PD) on CHIP</h2>

<p>If you want to build from source, these instructions will take you there.
PureData is a graphical programming environment, primarily for making audio and multimedia applications. This tutorial describes how to build the &ldquo;vanilla&rdquo; version of PD. This is a very rudimentary version of PD - it does not compile or build the extras objects, such as &ldquo;bob~&rdquo; or &ldquo;expr~&rdquo;.</p>

<h3 id="get-source">Get Source</h3>

<p>First, download and un-archive the source from Miller Puckette&rsquo;s website:</p>
<pre class="highlight shell"><code>wget http://msp.ucsd.edu/Software/pd-0.46-7.src.tar.gz
gzip -d pd-0.46-7.src.tar.gz
tar -xvf pd-0.46-7.src.tar
</code></pre>
<h3 id="install-dependencies">Install Dependencies</h3>

<p>Now, you&rsquo;ll need to install all the dependencies and make a symbolic link to wish:</p>
<pre class="highlight shell"><code>sudo apt-get update 
sudo apt-get install libasound2 alsa-utils mplayer software-properties-common git autoconf libtool make  build-essential gettext portaudio19-dev  jack libasound-dev qjackctl jackd2 tcl8.6 tk8.6 unzip
sudo apt-get build-dep puredata
sudo ln -s /usr/bin/wish8.6 /usr/bin/wish
</code></pre>
<p>Navigate to the pd directory the archive created:</p>
<pre class="highlight shell"><code><span class="nb">cd </span>pd-0.46-7
</code></pre>
<h3 id="build-it">Build It</h3>

<p>You&rsquo;re ready to go ahead and build, running some scripts, then making the install:</p>
<pre class="highlight shell"><code><span class="nb">cd</span> ~/pd-0.46-7/
./autogen.sh
./configure --disable-portaudio --disable-portmidi --no-recursion
make
sudo make install
</code></pre>
<p>You&rsquo;ll probably also want the &ldquo;extra&rdquo; objects such as expr, expr~, clone, fiddle~, bonk~, bob~, sigmund~, et al. 
These require an extra build step. The &ldquo;extra&rdquo; folder is in <code class="prettyprint">pd-0.46-7/extra</code>, so if you are still in <code class="prettyprint">src/</code> you can</p>
<pre class="highlight shell"><code><span class="nb">cd</span> ../extra
make install
</code></pre>
<p>You&rsquo;ll probably also want to install the deken plugin so you can add more externals to your bag of tricks:
https://github.com/pure-data/deken</p>

<p>I&rsquo;ve also found this kiosk plugin to be very handy for making a pure data widow take up the entire screen:
https://puredata.info/downloads/kiosk-plugin</p>

<h3 id="set-up-priority">Set Up Priority</h3>

<p>Now set up pd so it can run in real-time priority mode for low latency (launching with <code class="prettyprint">pd -rt</code>). 
This is mostly about giving audio the necessary thread priority and giving the chip user access:</p>
<pre class="highlight shell"><code>sudo nano /etc/security/limits.conf
</code></pre>
<p>Navigate to the end of the file (CTL-V) and add the lines</p>
<pre class="highlight shell"><code>@audio - rtprio 99
@audio - memlock unlimited
</code></pre>
<p>and save (CTL-X to exit, you&rsquo;ll be prompted to save)
You&rsquo;ll want to double check that the <code class="prettyprint">chip</code> user is in the audio group:</p>
<pre class="highlight shell"><code>sudo adduser username audio
</code></pre>
<p>Then reboot CHIP:</p>
<pre class="highlight shell"><code>sudo reboot
</code></pre>
<h3 id="test-pd">Test PD</h3>

<p>Now test pd with a test patch. Open a terminal and use this command, which should result in a sine wave:</p>
<pre class="highlight shell"><code>wget http://log.liminastudio.com/wp-content/uploads/2012/06/testPatch.pd_.zip
unzip testPatch.pd_.zip
pd -rt -nogui -noadc -alsa testPatch.pd
</code></pre>
<h3 id="test-midi-controller">Test MIDI Controller</h3>

<p>If you need to test out a midi controller to make sure data is coming into CHIP, you can do this from the terminal.
You&rsquo;ll want to list the connected devices, if not just to get the port name as ALSA sees it.</p>
<pre class="highlight shell"><code>amidi -l
</code></pre>
<p>Example output might look like
<code class="prettyprint">shell
Dir Device    Name
IO  hw:1,0,0  DS1 MIDI 1
</code></p>

<p>You can then use the command to display MIDI data bytes (in hex) in the terminal window:</p>
<pre class="highlight shell"><code>amidi -p hw:1,0,0 -d
</code></pre>
<p>Moving a fader might provide output like:</p>
<pre class="highlight shell"><code>B0 29 1D
B0 29 20
B0 29 24
B0 29 29
B0 29 2E
B0 29 32
B0 29 37
B0 29 3A
B0 29 3C
</code></pre>
<h3 id="uninstall">Uninstall</h3>

<p>If you need to remove pd, it takes a few steps:</p>
<pre class="highlight shell"><code>sudo apt-get remove puredata-core
sudo apt-get remove puredata-dev puredata-import puredata-utils
sudo apt-get purge puredata-core
sudo apt-get install aptitude wget unzip
sudo apt-get autoremove
</code></pre>
<h3 id="run-pd">Run PD</h3>

<p>Start PD from the terminal with the command</p>
<pre class="highlight shell"><code>pd -rt &amp;
</code></pre>
<p>You can then use the mouse and keyboard to go through the Browser and learn more about PD.</p>

<h3 id="references">References</h3>

<p>Here are some reference links</p>

<ul>
<li><a href="https://puredata.info/docs/faq/how-can-i-run-pd-with-realtime-priority-in-gnu-linux">real time priority mode</a></li>
<li><a href="http://www.alsa-project.org/main/index.php/Low_latency_howto">low latency alsa</a></li>
<li><a href="http://sourceforge.net/p/pure-data/pure-data/ci/master/tree/INSTALL.txt">pure data on sourceforge</a></li>
<li><a href="http://log.liminastudio.com/writing/tutorials/how-to-build-pd-extended-on-the-raspberry-pi">pd extended on RPi</a></li>
</ul>

          <h2 id="headless-chip">Headless CHIP</h2>

<p>One of the most amazing features of CHIP is that it&rsquo;s insanely simple to use it as small, wireless computer. Low power requirements, battery-powered with charge management, and both WiFi and Bluetooth connectivity makes CHIP easy to run as a headless, autonomous machine.
Of course, you&rsquo;ll still want to access it and control it without a monitor or keyboard. You can control CHIP with another computer and a serial or network connection. Here&rsquo;s how you do this.</p>

<h3 id="begin">Begin</h3>

<p>If you want to use CHIP without a monitor or keyboard attached, there&rsquo;s a few ways to do this:</p>

<ul>
<li>Serial connection between a computer and CHIP with a micro-USB cable (USB OTG)</li>
<li>Serial connection between a computer and CHIP with USB to UART cable</li>
<li>Secure Shell (SSH) over wireless or wired ethernet</li>
</ul>

<h3 id="requirements">Requirements</h3>

<ul>
<li>Computer running OS X 10.10+, Ubuntu 14.04+, or Windows 7+</li>
<li>CHIP</li>
<li>Micro-USB cable for USB OTG</li>
<li>USB-UART cable for USB serial</li>
<li>A <a href="#connecting-c-h-i-p-to-wi-fi-with-nmcli">network connection</a> for SSH</li>
</ul>

<h3 id="usb-on-the-go-serial-connection">USB On-The-Go Serial Connection</h3>

<p>Possibly the simplest method to connect to a CHIP is with USB OTG (On-The-Go) Serial. You can connect to CHIP with a micro-USB cable to your computer. Your computer will see CHIP as a serial device as well as provide power to the CHIP. Once you&rsquo;ve connected the USB cable to CHIP and your computer, you can read how to <a href="#control-chip-using-a-serial-terminal">control CHIP using a serial terminal</a></p>

<h3 id="usb-to-uart-serial-connection">USB to UART Serial Connection</h3>

<p>There are a few reasons you&rsquo;d want to use a serial connection:</p>

<ul>
<li>No wireless network</li>
<li>No USB-ethernet cable</li>
<li>Don&rsquo;t know the IP or network name of CHIP</li>
<li>You&rsquo;re old-school and like it</li>
<li>You need to see terminal output from the beginning of boot</li>
</ul>

<p>Connect a USB to UART cable to the Ground (GND), Transmit (TX), and Recieve (RX) pins on CHIP</p>

<p>We&rsquo;ll find those on header U14, pin outs 1,3 and 5.
See the following diagram, which assumes CHIP&rsquo;s USB ports are pointed up&hellip;</p>

<p><img src="images/chip_pinouts.jpg" alt="Pinout diagram for CHIP" /></p>

<h4 id="about-the-cable">About the Cable</h4>

<p>If you need a connector, search your favorite shop for &lsquo;USB to UART cable&rsquo; - any will do.</p>

<p>Here&rsquo;s the <a href="http://www.amazon.com/Armorview-PL2303HX-RS232-Module-Converter/dp/B008AGDTA4">one we bought</a>. Most of them will have a USB A plug for your computer on one end and four wires (red, green, black, and white) with female header pins on the other.</p>

<p>You may find other USB-UART cables that have more wires. There will be some labels that will help you connect to the correct pins (GND, TX, RX) on terminal U14.
Just be sure to check your datasheets to make sure you&rsquo;re using the correct pins.</p>

<h4 id="install-the-driver">Install the driver</h4>

<p>For this tutorial, we are using a PL2303 USB to Serial cable. 
If you are using this one too, you&rsquo;ll probably need to <a href="http://www.prolific.com.tw/US/ShowProduct.aspx?pcid=41&amp;showlevel=0041-0041">install the PL2303 driver</a> for your computer.</p>

<h4 id="connect-the-cable">Connect the Cable</h4>

<p>You only need to worry about three of the wires:</p>

<ul>
<li>Black = Ground (GND)</li>
<li>White = Transmit (TX)</li>
<li>Green = Receive (RX)</li>
</ul>

<p>The red wire carries voltage (+5 V).
DO NOT USE THE RED ONE.
Plugging in a +5 V pin could damage your CHIP</p>

<p>Again, there is a chance your USB to UART cable may be different.
Please check your data sheets!</p>

<p>The correct pins are on U14 at 1, 3, and 5.</p>

<p><img src="images/chip_pinouts.jpg" alt="Pinout diagram for CHIP" /></p>

<p>Here&rsquo;s a photo of the cable properly plugged in:</p>

<p><img src="images/uart_connection.jpg" alt="Properly connect USB to UART cable" /></p>

<h3 id="ssh">SSH</h3>

<p>SSH (or &ldquo;Secure Shell&rdquo;) is a common way to control a computer remotely over a network. You&rsquo;ll need to first get your computer&rsquo;s network name or IP address before you can connect.</p>

<h4 id="connect-to-chip-over-a-network">Connect to CHIP over a network</h4>

<p>CHIP comes with <code class="prettyprint">avahi</code> installed, meaning you can simply refer to it with a name, rather than an IP address</p>
<pre class="highlight shell"><code>ssh chip@chip.local
</code></pre>
<p>In some situations, you&rsquo;ll need to use CHIP&rsquo;s <a href="#how-to-get-your-ip-address">IP address</a> to connect, in which case the command would look like: </p>
<pre class="highlight shell"><code>ssh chip@10.1.1.99
</code></pre>
<p>You&rsquo;ll be asked for CHIP&rsquo;s password. The default password is <code class="prettyprint">chip</code>.
This process is the same if CHIP is connected to the network using built-in wireless or a USB-Ethernet adapter.</p>

<h5 id="how-to-get-your-ip-address">How to get your IP address</h5>

<p>The easiest way to get CHIPs IP address is to hook up a monitor and keyboard. Bootup, log in, <a href="#connecting-c-h-i-p-to-wi-fi-with-nmcli">connect to the network</a> if you need to, and use the command</p>
<pre class="highlight shell"><code>hostname -i
</code></pre>
<p>which results in your IP address, which might look like this:</p>
<pre class="highlight shell"><code>10.1.1.99
</code></pre>
<p>If the <code class="prettyprint">hostname -i</code> command doesn&rsquo;t work you can use</p>
<pre class="highlight shell"><code>ip addr show dev wlan0
</code></pre>
<p>(You can use the abbreviated <code class="prettyprint">ip a</code> for an easy to remember command).</p>

<p>which will output a lot of data. Look for the line <code class="prettyprint">wlan0</code> and the entry <code class="prettyprint">inet</code>, something like:</p>
<pre class="highlight shell"><code>inet 10.1.1.99
</code></pre>
<h4 id="make-connections-to-chip-easy">Make Connections To CHIP Easy</h4>

<p>You may want to setup your network so it will always provide the same (static) IP address to CHIP. You can then rely on CHIP always having the same IP address. </p>

<p>Alternatively, you can <a href="#zero-configuration-networking">setup zero configuration networking</a> to give your CHIP an easily remembered name. </p>

<p>You are now free to do whatever it is you do with Linux command line on CHIP.</p>

<h3 id="control-chip-using-a-serial-terminal">Control CHIP Using a Serial Terminal</h3>

<p>Once you&rsquo;ve connected CHIP to your computer with the UART or USB cable, open up a terminal. There&rsquo;s lots out there. Here&rsquo;s a few:</p>

<ul>
<li>OS X: <a href="http://www.dalverson.com/zterm/">Zterm</a>, <code class="prettyprint">screen</code> (built-in to OS X terminal)</li>
<li>Windows: <a href="http://www.chipkin.com/using-putty-for-serial-com-connections-hyperterminal-replacement/">PuTTy</a> or <a href="https://cygwin.com">cygwin</a></li>
<li>Linux: <code class="prettyprint">screen</code>, <code class="prettyprint">cu</code></li>
</ul>

<p>No matter the software, you&rsquo;ll need to set some settings for the port (aka connection). You&rsquo;ll probably only need to set the baud rate, as the others will be defaults:</p>

<ul>
<li>Baud Rate (Data Rate): 115200</li>
<li>Data Bits: 8</li>
<li>Parity: none</li>
<li>Stop bits: 1</li>
<li>Flow control: none</li>
</ul>

<h4 id="using-screen">Using screen</h4>

<p>If you are using screen, the command will look something like this:</p>
<pre class="highlight shell"><code>screen /dev/tty.usbserial 115200 <span class="c"># on macOS</span>
screen /dev/ttyUSB0 115200 <span class="c"># on linux</span>
</code></pre>
<p>Here&rsquo;s a clever way that work on any system to just connect to the most recent serial device you plugged in:</p>
<pre class="highlight shell"><code>screen <span class="k">$(</span>ls -tw 1 /dev/tty<span class="k">*</span> | head -1<span class="k">)</span> 115200
</code></pre>
<p>What comes after the &rsquo;/dev/&rsquo; may vary among different systems and connections. You can narrow down the choices by using one of the commands</p>
<pre class="highlight shell"><code>ls /dev/tty<span class="k">*</span> <span class="c"># everything</span>
ls -t /dev/tty<span class="k">*</span> | head -5 <span class="c"># the five most recent </span>
</code></pre>
<p>to list the serial devices. </p>

<p>Now power up CHIP. You could do this at anytime, but you&rsquo;ll have the most reliable experience powering CHIP after connecting the USB-UART wires. If you make the serial connection after booting chip, you&rsquo;ll probably need to hit &#39;return&rsquo; on your keyboard a few times to get CHIP to send some data to you and print in your terminal.</p>

<p>You&rsquo;ll then be prompted for login. Defaults are username <code class="prettyprint">chip</code> and password <code class="prettyprint">chip</code>.</p>

<p>You are now free to do whatever it is you do with Linux command line on CHIP.</p>

<h4 id="using-putty">Using PuTTy</h4>

<p>If you are on Windows using PuTTy, you&rsquo;ll probably want to open the windows Device Manager to get the COM name for the serial port. The device won&rsquo;t show up in the Ports list until after the kernel loads and presents the device, so it may take a minute or so before Windows actually detects it.</p>

<p><img src="images/win_putty_00.jpg" alt="Device Manager showing serial ports" /></p>

<p>In the PuTTy configuration panel, you can now use the COM name to set it up. In this case, it&rsquo;s &ldquo;COM4&rdquo;:</p>

<p><img src="images/win_putty_01.jpg" alt="PuTTy configuration" /></p>

<p>Press &ldquo;Open&rdquo; to open a terminal window ,where you can log in to CHIP with username and password <code class="prettyprint">chip</code>.</p>

<p>You are now free to do whatever it is you do with Linux command line on CHIP.</p>

<h2 id="zero-configuration-networking">Zero Configuration Networking</h2>

<p>You can make working with CHIP on a local network much more convenient by installing zero-conf networking. OS X users may know this as “Bonjour”.</p>

<p>With zero-conf properly configured, your CHIP can be contacted using a name, such as <code class="prettyprint">chip.local</code>, rather than an IP. This is especially convenient, if you are moving CHIP to different networks that might assign different IP addresses. The key technology for this in Linux is the <code class="prettyprint">avahi</code> set of tools. There are a few related packages, but this tutorial is a minimal installation to get it up and running.</p>

<h3 id="requirements">Requirements</h3>

<ul>
<li>CHIP</li>
<li><a href="#headless-chip">SSH or serial connection to CHIP</a> or</li>
<li>Monitor and keyboard</li>
<li><a href="#connecting-c-h-i-p-to-wi-fi-with-nmcli">Connection to a network</a></li>
</ul>

<h3 id="install-avahi">Install avahi</h3>

<p>Getting avahi running is extremely simple. First, install the avahi-daemon:</p>
<pre class="highlight shell"><code>  sudo apt-get install avahi-daemon
</code></pre>
<p>to install the necessary libraries. 
You may want to configure the daemon with this service file so you can find Apple Bonjour devices from CHIP :</p>
<pre class="highlight shell"><code>  sudo nano /etc/avahi/services/afpd.service
</code></pre>
<p>Then just copy and paste this XML into it:</p>
<pre class="highlight shell"><code>&lt;?xml <span class="nv">version</span><span class="o">=</span><span class="s2">"1.0"</span> <span class="nv">standalone</span><span class="o">=</span><span class="s1">'no'</span>?&gt;&lt;!--<span class="k">*</span>-nxml-<span class="k">*</span>--&gt;
&lt;!DOCTYPE service-group SYSTEM <span class="s2">"avahi-service.dtd"</span>&gt;
&lt;service-group&gt;
&lt;name replace-wildcards<span class="o">=</span><span class="s2">"yes"</span>&gt;%h&lt;/name&gt;
&lt;service&gt;
&lt;<span class="nb">type</span>&gt;_afpovertcp._tcp&lt;/type&gt;
&lt;port&gt;548&lt;/port&gt;
&lt;/service&gt;
&lt;/service-group&gt;
</code></pre>
<p>Then restart avahi-daemon:</p>
<pre class="highlight shell"><code> sudo /etc/init.d/avahi-daemon restart
</code></pre>
<p>You can now find the hostname that you can use to reach CHIP:</p>
<pre class="highlight shell"><code>  hostname
</code></pre>
<p>which will probably return “chip” as the hostname.</p>

<h3 id="use-zero-conf">Use Zero-Conf</h3>

<p>From a terminal on another computer you can try accessing CHIP with the network name <code class="prettyprint">chip.local</code></p>
<pre class="highlight shell"><code>  ssh chip@chip.local
</code></pre>
<p>and enter the password (default is <code class="prettyprint">chip</code>). That&rsquo;s it. You can now reach CHIP without knowing the IP.</p>

<h3 id="change-the-hostname">Change the hostname</h3>

<p>If you have more than one CHIP on the network, or you just want to change the name from “chip” to fit into your network name scheme, you can modify the hostnames file. Open the file in an editor:</p>
<pre class="highlight shell"><code>  sudo nano /etc/hostname
</code></pre>
<p>where you&rsquo;ll see a single word “chip.” Just modify that line (for example, change it to “bobofettywap”) and save the file. 
You&rsquo;ll also need to modify the hosts file where you&rsquo;ll need to change the first line <code class="prettyprint">127.0.0.1    chip</code> where you replace &ldquo;chip&rdquo; with your new hostname.</p>
<pre class="highlight shell"><code>  sudo nano /etc/hosts
</code></pre>
<p>Finally, to get this new name to broadcast over the network restart avahi-daemon:</p>
<pre class="highlight shell"><code>  sudo /etc/init.d/avahi-daemon restart
</code></pre>
<p>You can now access chip with the new name:</p>
<pre class="highlight shell"><code>  ssh chip@bobofettywap.local 
</code></pre>
<h3 id="other-packages">Other packages</h3>

<p>You may want to explore some of the other features of avahi, such as browsing a network for other zero-configure enabled computers. There&rsquo;s a package you can install:</p>
<pre class="highlight shell"><code>  sudo apt-get update &amp;
  sudo apt-get install avahi-utils
</code></pre>
<p>which gives you a set of tools for browsing the network, such as the command</p>
<pre class="highlight shell"><code>  avahi-browse -d <span class="nb">local </span>_ssh._tcp --resolve -t
</code></pre>
<p>which will list other zero-configure-enabled devices on the local network. You could ssh to your Macintosh named &ldquo;bananna&rdquo;, for example with </p>
<pre class="highlight shell"><code>  ssh username@bananna
</code></pre>
<p>An alternative to just installing the avahi-daemon, you can</p>
<pre class="highlight shell"><code>  sudo apt-get install libnss-mdns
</code></pre>
<p>which installs some other tools for network name propagation.</p>

<h3 id="troubleshooting-ssh-with-avahi">Troubleshooting SSH with avahi</h3>

<p>If your computer returns the error</p>
<pre class="highlight shell"><code>  ssh: Could not resolve hostname chip.local: nodename nor servname provided, or not known
</code></pre>
<p>then you either need to wait a minute or try installing avahi-daemon again, but pay closer attention to any errors that <code class="prettyprint">apt-get</code> returns.</p>

<p>If you can&rsquo;t connect to CHIP even though you are sure avahi is properly configured, confirm that your CHIP and the computer you are trying to connect are on the same local network (and on the same subnet).</p>

          <h1 id="faqs">FAQs</h1>

<p>Frequently Asked Questions</p>

<h2 id="do-i-need-to-install-something-for-chip-to-be-a-computer">Do I need to install something for CHIP to be a computer?</h2>

<p>No. CHIP comes preinstalled with the CHIP Operating System and several applications. Just power on, and get started.</p>

<h2 id="why-composite-video">Why composite video?</h2>

<p>Several reasons:</p>

<ul>
<li>Televisions are the most commonly available screen in the world and the vast majority of them have a composite input.</li>
<li>Composite video can be integrated without adding licensing fees to the cost of C.H.I.P.</li>
<li>Composite is a very low profile connector, allowing us to keep the footprint of the board small for people wanting to build C.H.I.P. into projects.</li>
</ul>

<h2 id="is-chip-an-exposed-circuit-board">Is CHIP an exposed circuit board?</h2>

<p>Yes! Not having a case for C.H.I.P. is one of the ways we are able to keep our costs down. As makers, we’re excited to introduce people to the physical components of computers and show them that electronics aren’t scary, they’re fun! We hope to spark curiosity and encourage people to begin tinkering themselves.</p>

<h2 id="what-resolution-can-chip-function-at">What resolution can CHIP function at?</h2>

<p>With the VGA and HDMI adapters, C.H.I.P. is designed to work at 720p resolution, though the Mali 400 GPU is technically capable of up to 1080p outputs. The composite video connector operates at the &ldquo;SD&rdquo; resolution of 640x480.</p>

<h2 id="how-is-chip-so-cheap">How is CHIP so cheap?</h2>

<p>QUANTITY. Our partners at Allwinner worked hard to help us find how to reduce costs, so  we could introduce C.H.I.P. to EVERYBODY. To sell C.H.I.P. for $9, we need to order tens of thousands of chips. By using common, available, and volume-produced processor, memory, and wifi chips, we are able to leverage the scales at which tablet manufacturers operate to get everyone the best price.</p>

<h2 id="what-does-chip-stand-for">What does CHIP stand for?</h2>

<p>We’re curious to hear what you think ;)</p>

<h2 id="is-chip-open-source-where-are-the-docs">Is CHIP open source? Where are the docs?</h2>

<p>YES!  Very open source!  We are still in the process of testing and refining the whole C.H.I.P. family.  As we hit design completion, we&rsquo;ll release our design files.  We&rsquo;ve already released quite a bit!  Check them out at <a href="https://github.com/NextThingCo">our GitHub repo</a>!</p>

<h2 id="can-i-upgrade-chip-39-s-ram-storage-processor">Can I upgrade CHIP&rsquo;s RAM/Storage/Processor?</h2>

<p>Technically, yes, but the components are soldered on and not intended to be swapped out. If you really like reworking small BGA and fine pitch components, though, we won&rsquo;t stop you. :)</p>

<p>If you want additional storage, you can attach a USB drive!</p>

<h2 id="how-many-accessible-pins-does-chip-have">How many accessible pins does CHIP have?</h2>

<p>Eight digital GPIOs, one PWM pin, SPI, TWI (I2C), UART, USB, CSI, Parallel LCD output, touchpanel input, stereo audio out, mono audio in, composite video out, and a whole bunch of power rails in and out.</p>

<p>The most up-to-date information is on <a href="https://github.com/PopcornComputer">our GitHub repo</a>.</p>

<h2 id="can-i-make-my-own-adapter-board">Can I make my own adapter board?</h2>

<p>Absolutely! The schematics and layout for the boards, both of C.H.I.P. and C.H.I.P.’s adapters will be released as they are finalized for production. From that, you can build whatever sort of adapters or add-ons you want!</p>

<h2 id="does-the-hdmi-adapter-have-hdmi-audio-output">Does the HDMI adapter have HDMI audio output?</h2>

<p>Not at this time. Because there is no onboard digital audio support from our processor, C.H.I.P.’s current design only has analog audio output via the ⅛” headphone/composite jack. Adding a USB sound card is the easiest way to beef up your CHIP’s digital audio output options.</p>

<h2 id="does-linux-come-pre-installed">Does Linux come pre-installed?</h2>

<p>YES! C.H.I.P. comes with Linux installed, and a selection of our favorite programs and games. Like any real computer, you can download more software and customize C.H.I.P.s applications and operating system to suit your needs!</p>

<h2 id="can-i-plug-in-a-keyboard-mouse-and-power">Can I plug in a Keyboard, Mouse, AND Power?</h2>

<p>The easiest way to accomplish this is to power C.H.I.P. as usual via the microUSB port. Attach a USB keyboard with an accessory USB port on it, then connect your wired mouse to that port. Alternatively, a bluetooth keyboard or mouse can be used to free up the need for USB connections.</p>

<p>For more advanced use cases, C.H.I.P. can be powered via its interconnects, leaving both the full size USB and microUSB ports available to attach devices to.</p>

<h2 id="can-i-stream-netflix">Can I stream Netflix?</h2>

<p>Due to a lack of support for Silverlight (the back-end software that allows Netflix to be streamed) in Linux, it is unlikely that Netflix will work on C.H.I.P. using entirely open-source software. This would require someone to come up with an alternate back-end. That said, some very astute backers have reported that Netflix should be possible by installing the Google Chrome browser, which allows Netflix streaming via HTML5.</p>

<h2 id="does-chip-have-a-power-switch">Does CHIP have a power switch?</h2>

<p>Yes! C.H.I.P. has a tiny power on-off button and a status LED on the board itself.</p>

<h2 id="can-i-make-a-supercomputer-by-linking-100-chips-together">Can I make a supercomputer by linking 100 CHIPs together?</h2>

<p>We’re focused on individual uses of C.H.I.P. but what you’re talking about is called clustering, and may be possible &ndash; A good place to start, if you’re interested in clustering, is reading up on <a href="https://www.debian.org/ports/beowulf/">Debian-Beowulf</a></p>

<h2 id="what-about-a-camera">What about a camera?</h2>

<p>C.H.I.P. has exposed CSI pins on its headers for integrating a camera directly to the processor, or if drivers and sensor tuning sound like a bit much, you can always add a USB camera too.</p>

<h2 id="how-do-i-connect-a-display">How do I connect a display?</h2>

<p>You can connect a display through the 3.5mm (⅛”) TRRS composite video port on C.H.I.P. If you’d like to connect to a vga or hdmi monitor, we have adapters available for that! You can also connect any parallel LCD to the exposed display pins on C.H.I.P.’s headers.</p>

<h2 id="does-chip-have-an-sd-card-slot">Does CHIP have an SD card slot?</h2>

<p>No. But by integrating reliable storage onto the device, we’re able to both save you a “getting started” cost and allow Linux to come preinstalled on C.H.I.P. meaning it&rsquo;s ready to go when it arrives at your door. One of the big goals of this project is making C.H.I.P. easy to use, and this goes a long way towards that end. If you need additional storage, it’s easy to add an SD card reader or other USB storage with the built-in USB port.</p>

<h2 id="can-i-connect-to-composite-video-and-audio-out-at-the-same-time">Can I connect to composite video AND audio out at the same time?</h2>

<p>YES! The 1/8&quot; mini (TRRS) jack can be used either with a video-only cable, audio only cable, headphones, headphones with mic, OR a combined Audio/Video composite cable. Pretty versatile little port, isn&rsquo;t it!?</p>

<h2 id="what-software-does-chip-ship-with-what-programs-can-it-run">What software does CHIP ship with? What programs can it run?</h2>

<p>C.H.I.P. comes pre-loaded with some of our favorite open-source applications, and the ability to install hundreds more. What’s even more exciting, though, is that if any given program isn’t supported out of the box, the community can work together to make it happen. That’s what we &lt;3 about Open Source Software.</p>

<h2 id="what-programming-languages-does-chip-support">What programming languages does CHIP support?</h2>

<p>C.H.I.P. is a <strong>real computer</strong>, and can run software written in all kinds of programming languages, so long as there’s a compiler for them. Python, Java (via JDK8), Ruby, PHP, Squeak, C++, JS, Assembly, BF.. even our favorite, ArnoldC, and lots lots more.</p>

<h2 id="does-chip-have-real-time-clock">Does CHIP have Real Time Clock?</h2>

<p>No, but adding an RTC is a great (and easy) hardware hack, for the folks that need it. For most people, though, an RTC isn’t necessary since it is easy to get C.H.I.P. to pull time from a remote NTP server over wifi.</p>

<h2 id="what-voltage-are-gpios">What voltage are GPIOs?</h2>

<p>CHIP uses 3V3 digital logic on GPIOs.</p>

<h2 id="what-connector-is-used-on-the-battery">What connector is used on the battery?</h2>

<p>We are using a JST-2.0 PH 2-pin shrouded male connector to connect LiPo cells to C.H.I.P. In the current design there are also BATT pins available on the interconnect headers, which allow alternate battery connectors/placements when attaching C.H.I.P. to a custom PCBA.</p>

<h2 id="i-want-to-know-more-about-the-allwinner-r8-processor">I want to know more about the Allwinner R8 processor!</h2>

<p>You can find out more from the <a href="https://github.com/NextThingCo/CHIP-Hardware/blob/master/CHIP%5Bv1_0%5D/CHIPv1_0-BOM-Datasheets/Allwinner%20R8%20User%20Manual%20V1.1.pdf">Allwinner R8 User Manual</a> and the <a href="https://github.com/NextThingCo/CHIP-Hardware/blob/master/CHIP%5Bv1_0%5D/CHIPv1_0-BOM-Datasheets/Allwinner%20R8%20Datasheet%20V1.2.pdf">R8 Datasheet</a></p>

<h2 id="what-kind-of-battery-can-i-use-with-chip">What kind of battery can I use with CHIP?</h2>

<p>Any single-cell (3.7V) LiPo battery will work with C.H.I.P. You can go bigger or smaller than 3000mAH as needed for your project!</p>

<h2 id="does-chip-39-s-wifi-support-ap-mode">Does CHIP&rsquo;s WiFi support AP mode?</h2>

<p>YES!</p>

<h2 id="does-c-h-i-p-have-an-ethernet-port">Does C.H.I.P. have an ethernet port?</h2>

<p>No. But it does have built-in 802.11b/g/n wifi. But if you like wires, you can use a USB-Ethernet connector.</p>

<h2 id="is-there-a-command-that-lets-me-know-more-about-the-cpu-and-memory">Is there a command that lets me know more about the CPU and Memory?</h2>

<p>It&rsquo;s a computer! It will tell you anything. If you want to find out more details about CHIP&rsquo;s processor, use the command:</p>
<pre class="highlight shell"><code>cat /proc/cpuinfo
</code></pre>
<p>This will give output similar to:</p>
<pre class="highlight shell"><code>processor   : 0
model name  : ARMv7 Processor rev 2 <span class="o">(</span>v7l<span class="o">)</span>
BogoMIPS    : 1001.88
Features    : half thumb fastmult vfp edsp neon vfpv3 tls vfpd32
CPU implementer : 0x41
CPU architecture: 7
CPU variant : 0x3
CPU part    : 0xc08
CPU revision    : 2

Hardware    : Allwinner sun4i/sun5i Families
Revision    : 0000
Serial      : 162542c10c427777
</code></pre>
<p>If you want know more about the memory:</p>
<pre class="highlight plaintext"><code>cat /proc/meminfo
</code></pre>
<p>with output something like:</p>
<pre class="highlight shell"><code>MemTotal:         507108 kB
MemFree:          298600 kB
MemAvailable:     382592 kB
Buffers:               0 kB
Cached:            92216 kB
SwapCached:            0 kB
Active:            98752 kB
Inactive:          64096 kB
Active<span class="o">(</span>anon<span class="o">)</span>:      73180 kB
Inactive<span class="o">(</span>anon<span class="o">)</span>:     5812 kB
Active<span class="o">(</span>file<span class="o">)</span>:      25572 kB
Inactive<span class="o">(</span>file<span class="o">)</span>:    58284 kB
Unevictable:           0 kB
Mlocked:               0 kB
HighTotal:             0 kB
HighFree:              0 kB
LowTotal:         507108 kB
LowFree:          298600 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                 0 kB
Writeback:             0 kB
AnonPages:         70660 kB
Mapped:            37768 kB
Shmem:              8360 kB
Slab:              22784 kB
SReclaimable:      11560 kB
SUnreclaim:        11224 kB
KernelStack:        1176 kB
PageTables:         2240 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:      253552 kB
Committed_AS:     615216 kB
VmallocTotal:     507904 kB
VmallocUsed:       14560 kB
VmallocChunk:     482532 kB
</code></pre>
          <h1 id="troubleshooting-faq">Troubleshooting FAQ</h1>

<h2 id="chip-won-39-t-boot-or-startup">CHIP Won&rsquo;t Boot or Startup</h2>

<p><strong><em>Problem:</em></strong> I attached a keyboard, monitor, and powered CHIP, but it does not do anything. The LEDs are on, but I can&rsquo;t do anything with CHIP!</p>

<p><strong><em>Fixes:</em></strong> Don&rsquo;t worry, your CHIP is probably fine. This can be fixed by reflashing CHIP from our web flasher.</p>

<ul>
<li>Follow the instructions <a href="#flash-chip-with-an-os">for flashing your CHIP</a>.</li>
</ul>

<h2 id="sudden-shutdown-brown-out">Sudden Shutdown (Brown-out)</h2>

<p><strong><em>Problem:</em></strong> I attached a mouse and keyboard, and my CHIP suddenly turned off.</p>

<p><strong><em>Fixes:</em></strong> Like most tiny computers, the USB port on CHIP provides a limited amount of power. When you plug in a keyboard and an optical mouse, for example, they will draw too much current from CHIP, not leaving enough for the processor. As a result, CHIP will immediately shut down. There are a few ways to avoid this. </p>

<ul>
<li> Use a <a href="#powered-usb-hub">powered USB hub</a></li>
<li> Use a <a href="#bluetooth-keyboard-and-mouse">bluetooth keyboard and mouse</a>. Yes, this is a very specific solution, but a good one when you are only using the USB port for keyboard and mouse. Keeps your desk cleaner too!</li>
<li> Execute the command <code class="prettyprint">sudo axp209 --no-limit</code> in the terminal before you attach your USB peripherals.</li>
<li> Provide power from a supply connecting ground and 5V the pins <a href="#pin-headers">headers 1 and 2 on U13</a>.</li>
</ul>

<p><strong><em>Problem:</em></strong> My CHIP booted fine until it got to loading the desktop GUI, then it shut down.</p>

<p><strong><em>Fixes:</em></strong> This is usually the result of an underpowered power supply. We recommend a 5V power supply with a minimum 1A current rating. </p>

<ul>
<li> You can find the current rating on your power supply&rsquo;s &ldquo;Output&rdquo; - it should read <em>1000 mA</em> or <em>1A</em> (or a higher number). You may need a magnifying glass to read it, but they all should have this info on the label!</li>
<li> Instead of powering CHIP using the microUSB port, try using the <a href="#pin-headers">header pins</a> CHG-IN (U13-2) and GND (U13-1). </li>
<li> Add a <a href="#power-from-a-battery">LiPo battery</a>. This provides enough extra current and power buffer to prevent this problem. </li>
</ul>

<h2 id="no-video-output">No Video Output</h2>

<p>Problem: Monitor is attached, but there is no video on my monitor</p>

<p>Fixes: There are a few possible problems here</p>

<ul>
<li> <strong>wrong TRRS arrangement</strong>: try different ends of your cable. Make sure is subscribes to <a href="#about-the-trrs-connector">this use of the tip, rings, and sleeve</a></li>
<li> <strong>PAL monitor</strong>: CHIP outputs NTSC format video by default. You can change this, however, by following <a href="#ntsc-or-pal">this guide</a>.</li>
<li> <strong>Video trace cut for mic in</strong>: This is pretty unlikely, but if you are working with a used CHIP, it may be that the tip connector has been switched to <a href="#microphone-and-audio-input">work as a microphone input</a>. Before you do fix this with a bit of solder, take a close look at your board to see if there is evidence of a score mark indicating the cut trace. </li>
</ul>

<h2 id="how-to-contact-us">How to Contact Us</h2>

<p>If you need more support, try our <a href="https://bbs.nextthing.co">forums</a> or 
<a href="mailto:ahoyahoy@nextthing.co?subject=&quot;C.H.I.P.%20S.O.S.&quot;">email</a> us.</p>

          <h1 id="compliance-statement">Compliance Statement</h1>

<p><strong>FCC ID: 2AF9F-HELLA1337</strong></p>

<p><strong>IC: 20863-HELLA1337</strong></p>

<h2 id="fcc">FCC</h2>

<p>This device complies with part 15 of the FCC Rules. Operation is subject to the following two conditions: (1) This device may not cause harmful interference, and (2) this device must accept any interference received, including interference that may cause undesired operation.</p>

<h2 id="industry-canada">Industry Canada</h2>

<p>This device complies with Industry Canada license-exempt RSS standard(s). Operation is subject to the following two conditions:</p>

<ol>
<li>This device may not cause harmful interference;</li>
<li>This device must accept any interference received, including interference that may cause undesired operation of the device.</li>
</ol>

<p>Cet appareil est conforme à Industrie Canada une licence standard RSS exonérés (s). Son fonctionnement est soumis aux deux conditions suivantes:
1. Cet appareil ne doit pas provoquer d&#39;interférences
2. Cet appareil doit accepter toute interférence reçue, y compris les interférences pouvant provoquer un fonctionnement indésirable de l&#39;appareil.</p>

<h2 id="information-to-user">Information to User</h2>

<p>CAUTION: Changes or modifications not expressly approved for compliance could void your authority to operate this equipment.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
